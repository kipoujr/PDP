(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{10:function(e,t,n){"use strict";var i=n(19),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=void 0;t.a=((o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.a),r(t,[{key:"initialize",value:function(e){null==e&&(e={});var n=e;return this.action=n.action,this.label=n.label,this.title=n.title,this.icon=n.icon,null==this.title&&this.label&&(this.title=this.label),this.render(),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"render",value:function(){if(this.$el.attr("href","#"),null!=this.action&&this.$el.attr("data-action",this.action),null!=this.label&&this.$el.html(this.label),null!=this.title&&this.$el.attr("title",this.title),null!=this.icon)return this.$el.prepend('<i class="'+this.icon+'"></i> ')}},{key:"setTitle",value:function(e){return this.title=e,this.label=e,this.render()}}],[{key:"initClass",value:function(){this.prototype.className="button",this.prototype.tagName="a"}}]),t}()).initClass(),o=o)},11:function(e,t,n){"use strict";var i=n(0),r=n.n(i),o=n(1),a=n(19),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0};var u=void 0;t.a=((u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.a),s(t,[{key:"initialize",value:function(e){return this._click=this._click.bind(this),this._keydown=this._keydown.bind(this),null==e&&(e={}),this.bindings=[],this._bindTo(r()(document),"keydown",this._keydown),this.build(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"build",value:function(){return this.$innerEl=r()('<div class="lightbox-inner"></div>').appendTo(this.el),this.innerEl=this.$innerEl.get(0),r()("body").addClass("lightbox-open")}},{key:"close",value:function(){return this._unbindFromAll(),this.off(),this.remove(),r()("body").removeClass("lightbox-open")}},{key:"_click",value:function(e){var n=r()(e.target),i=n.attr("href");return i&&"#"===i&&e.preventDefault(),this.leaveWhenMaskClicked&&n.is(".lightbox")&&this.visible()?this._leave():l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_click",this).call(this,e)}},{key:"_keydown",value:function(e){if(this.leaveWhenEscapePressed&&e.keyCode===this.escapeKeyCode&&this.visible())return e.preventDefault(),this._leave()}},{key:"_leave",value:function(e){return this.trigger("leave",this),e&&e.preventDefault(),this.close()}},{key:"_bindTo",value:function(e,t,n){return e.bind(t,n),this.bindings.push({source:e,event:t,callback:n})}},{key:"_unbindFromAll",value:function(){return Object(o.each)(this.bindings,function(e){return e.source.unbind(e.event,e.callback)}),this.bindings=[]}}],[{key:"initClass",value:function(){this.prototype.className="lightbox",this.prototype.tagName="section",this.prototype.leaveWhenEscapePressed=!0,this.prototype.leaveWhenMaskClicked=!0,this.prototype.escapeKeyCode=27}}]),t}()).initClass(),u=u)},13:function(e,t,n){"use strict";n.r(t);var i=n(1),r=n(3),o=n(14),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0};var l=void 0;t.default=((l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.View),a(t,[{key:"initialize",value:function(e){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._handleClick=this._handleClick.bind(this),this._handleSelect=this._handleSelect.bind(this),this.title=e.title,this.render(),this.inputEl=this.$el.find("input"),this.inputEl.on("click",function(e){return e.stopPropagation()}),Object(o.a)(this.inputEl,{autoFocus:e.autoFocus,select:this._handleSelect,source:e.source,inline:!0,limit:e.limit||10,autoSelect:!0})}},{key:"render",value:function(){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this),this.$el.html(this.template({title:this.title}))}},{key:"setSource",value:function(e){return this.inputEl.data("autocomplete").setSource(e)}},{key:"reset",value:function(){return this.label=void 0,this._updateTitle()}},{key:"open",value:function(){return this.$el.addClass("open"),this.inputEl.val("").focus(),this._updateTitle(),document.addEventListener("click",this._handleClick,!0)}},{key:"close",value:function(){return this.$el.removeClass("open"),this._updateTitle(),document.removeEventListener("click",this._handleClick,!0)}},{key:"_updateTitle",value:function(){return this.$el.find(".chooser-view-title").html(this.label||this.title)}},{key:"_handleClick",value:function(e){if(e.stopPropagation(),e.target!==this.inputEl.get(0))return this.$el.hasClass("open")?this.close():this.open()}},{key:"_handleSelect",value:function(e,t){return this.label=t.item.label||t.item,this.trigger("selected",t.item),this.close()}}],[{key:"initClass",value:function(){this.prototype.tagName="div",this.prototype.className="chooser-view",this.prototype.events={click:"_handleClick"},this.prototype.template=Object(i.template)('<div class="chooser-view-selection-pane">\n  <span class="chooser-view-title"><%- title %></span>\n  <i class="icon-caret-down closed"></i>\n  <i class="icon-caret-up opened"></i>\n  <div class="chooser-view-autocomplete-wrapper">\n    <i class="icon-search"></i>\n    <input type="text" name="autocomplete">\n  </div>\n</div>')}}]),t}()).initClass(),l=l)},134:function(e,t,n){"use strict";var i=n(0),r=n.n(i),o=n(3),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var s=void 0;t.a=((s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.View),a(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._url=this._url.bind(this),this.institutionSlug=e.institutionSlug}},{key:"_performResearchAndExpertSearch",value:function(e){e.preventDefault();var t=r()("#expert_search_form_term").val();if(""!==t)return window.location.href=this._url(t)}},{key:"_toSlug",value:function(e,t){return e.replace(/\s/g,t).toLowerCase()}},{key:"_url",value:function(e){return this.institutionSlug?"/experts/search/on/"+this._toSlug(e,"+")+"/from/"+this.institutionSlug:"/experts/search/on/"+this._toSlug(e,"+")}}],[{key:"initClass",value:function(){this.prototype.events={"submit .expert_search_form.for":"_performResearchAndExpertSearch"}}}]),t}()).initClass(),s=s)},14:function(e,t,n){"use strict";var i=n(0),r=n.n(i),o=n(1),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.a=function(e,t){null==t&&(t={});var n=function(){function e(t,n){s(this,e),this._delayedUpdate=this._delayedUpdate.bind(this),this.renderCallback=n,this.setSource(t)}return a(e,[{key:"setSource",value:function(e){return e instanceof Array?(this.update=this._arrayUpdate,this.sourceArray=e):e instanceof Function?(this.update=this._callbackUpdate,this.sourceCallback=e):(this.update=this._ajaxUpdate,this.sourceUrl=e)}},{key:"cancelRequests",value:function(){return clearTimeout(this.delayedUpdate),null!=this.ajax?this.ajax.abort():void 0}},{key:"_arrayUpdate",value:function(e){var t=this._buildResults(e,this.sourceArray);return this.renderCallback(t)}},{key:"_ajaxUpdate",value:function(e){var t=this;return clearTimeout(this.delayedUpdate),this.delayedUpdate=setTimeout(function(){return t._delayedUpdate(e)},300)}},{key:"_callbackUpdate",value:function(e){var t=this._buildResults(e,this.sourceCallback());return this.renderCallback(t)}},{key:"_delayedUpdate",value:function(e){return null!=this.ajax&&this.ajax.abort(),this.ajax=r.a.ajax({url:this.sourceUrl,data:{term:e},dataType:"json",success:this.renderCallback})}},{key:"_buildResults",value:function(e,t){return Object(o.filter)(t,function(t){return-1!==(t.label||t).toLowerCase().indexOf(e.toLowerCase())})}}]),e}(),i=function(){function e(t,n,i,o){s(this,e);var a=void 0;this._closeOnClickOutside=this._closeOnClickOutside.bind(this),this.selectPreviousItem=this.selectPreviousItem.bind(this),this.selectNextItem=this.selectNextItem.bind(this),this.chooseItem=this.chooseItem.bind(this),this.chooseSelectedItem=this.chooseSelectedItem.bind(this),this.clear=this.clear.bind(this),this.render=this.render.bind(this),this._renderItem=this._renderItem.bind(this),null==o&&(o=!1),this.ul=document.createElement("ul"),this.ul.className="autocomplete",this.attachElement=t,this.renderInline=n,this.limit=i||20,this.autoSelect=o,this.renderInline?a=this.attachElement.parentNode:(a=document.body,this.ul.style.position="absolute"),a.appendChild(this.ul),this.clear(),r()(document).on("mousedown",this._closeOnClickOutside)}return a(e,[{key:"_isEventTargetInWidget",value:function(e){return e.target===this.ul||r.a.contains(this.ul,e.target)}},{key:"_closeOnClickOutside",value:function(e){if(!this._isEventTargetInWidget(e))return this.ul.style.display="none"}},{key:"getSelectedIndex",value:function(){return this.selectedIndex}},{key:"setSelectedIndex",value:function(e){if(this.selectedIndex!==e)return this._clearSelection(),this.selectedIndex=e,this._updateSelection()}},{key:"setSelectionCallback",value:function(e){return this.callback=e}},{key:"selectPreviousItem",value:function(){return this._clearSelection(),this.validSelection()?this.selectedIndex>0&&this.selectedIndex--:this.selectedIndex=0,this._updateSelection()}},{key:"selectNextItem",value:function(){return this._clearSelection(),this.validSelection()?this.selectedIndex<this.selectionLimit&&this.selectedIndex++:this.selectedIndex=0,this._updateSelection()}},{key:"chooseItem",value:function(e,t){var n={item:this.items[t]};return"function"==typeof this.callback?this.callback(e,n):void 0}},{key:"chooseSelectedItem",value:function(e){return this.chooseItem(e,this.selectedIndex),this.clear()}},{key:"clear",value:function(){var e=void 0;for(this.selectedIndex=void 0;e=this.ul.firstChild;)this.ul.removeChild(e);return this.ul.style.display="none",this.opened=!1}},{key:"render",value:function(e){if(this.items=e.slice(0,this.limit),this.clear(),this.selectionLimit=this.items.length-1,Object(o.each)(this.items,this._renderItem),this._updateSelection(),this.renderInline||(this.position=this._getAttachmentPoint(this.attachElement),this.ul.style.top=this.position[0]+"px",this.ul.style.left=this.position[1]+"px"),this.ul.style.display="block",this.opened=!0,this.autoSelect)return this.selectNextItem()}},{key:"isOpen",value:function(){return this.opened}},{key:"validSelection",value:function(){return void 0!==this.selectedIndex}},{key:"_getAttachmentPoint",value:function(e){var t=void 0,n=t=0;if(e.offsetParent)for(t+=e.offsetHeight;t+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;);return[t,n]}},{key:"_renderItem",value:function(e,t){var n=this,i=document.createElement("li");i.className="autocomplete-item";var o=e.label||e;return r()(i).html(o),this.ul.appendChild(i),r()(i).on("mouseover",function(){return n.setSelectedIndex(t)}),r()(i).on("mouseup",function(e){return n.chooseItem(e,t),n.clear()})}},{key:"_clearSelection",value:function(){return null!=this.ul.childNodes[this.selectedIndex]?this.ul.childNodes[this.selectedIndex].className="autocomplete-item":void 0}},{key:"_updateSelection",value:function(){var e=void 0;if(e=this.ul.childNodes[this.selectedIndex]){var t=r()(this.ul).height(),n=r()(e).outerHeight(),i=r()(this.ul).scrollTop(),o=t+i,a=n*this.selectedIndex;return a<=i&&r()(this.ul).scrollTop(a),a>=o&&r()(this.ul).scrollTop(a-(t-n)),e.className="autocomplete-item selected"}}}]),e}(),l=new(function(){function e(t,r){s(this,e),this.setSource=this.setSource.bind(this),this.handleItemSelection=this.handleItemSelection.bind(this),this._handleFocus=this._handleFocus.bind(this),this._handleKeyup=this._handleKeyup.bind(this),this._handleKeydown=this._handleKeydown.bind(this),r.select&&(this.select=Object(o.bind)(r.select,t)),this.autoFocus=r.autoFocus,this.element=t,this.element.attr("autocomplete","off"),this.menu=new i(this.element.get(0),r.inline,r.limit,r.autoSelect),this.menu.setSelectionCallback(this.handleItemSelection),this.suggestions=new n(r.source,this.menu.render),this.element.on("keydown",this._handleKeydown),this.element.on("keyup",this._handleKeyup),this.element.on("focus",this._handleFocus),this.element.trigger("autocompletecreate")}return a(e,[{key:"setSource",value:function(e){return this.suggestions.setSource(e)}},{key:"handleItemSelection",value:function(e,t){return"function"==typeof this.select&&this.select(e,t),this.element.trigger("autocompleteselect",t),this.searchText=this.element.val()}},{key:"_handleFocus",value:function(e){if(this.autoFocus)return this.suggestions.update("")}},{key:"_handleKeyup",value:function(e){var t=""+e.target.value;if(this.searchText!==t&&t.length>=2)return this.searchText=t,this.suggestions.update(t)}},{key:"_handleKeydown",value:function(e){switch(e.which){case 38:return e.preventDefault(),this.menu.selectPreviousItem();case 40:return e.preventDefault(),this.menu.selectNextItem();case 27:return e.preventDefault(),this.menu.clear();case 13:if(this.menu.validSelection()||(this.suggestions.cancelRequests(),this.menu.clear()),this.menu.isOpen()&&this.menu.validSelection())return e.preventDefault(),this.suggestions.cancelRequests(),this.menu.chooseSelectedItem(e)}}}]),e}())(e,t);return e.data("autocomplete",l)}},15:function(e,t,n){"use strict";var i=n(1),r=n(3),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=void 0;t.a=((a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.View),o(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),null!=e&&(e.size&&this.$el.css("font-size",e.size),null!=e.centered==1&&this.$el.addClass("centered"),null!=e.fixed==1&&this.$el.addClass("fixed"),e.backgroundColor&&e.foregroundColor&&(this.$el.css("border-color",e.backgroundColor),this.$el.css("border-top-color",e.foregroundColor))),this.render()}},{key:"show",value:function(e){var t=this;return this.$el.show(),this.visible()?"function"==typeof e?e():void 0:(Object(i.defer)(function(){return t.$el.removeClass("hidden")}),null!=e?Object(i.delay)(e,500):void 0)}},{key:"hide",value:function(e){var t=this;return this.visible()?(Object(i.defer)(function(){return t.$el.addClass("hidden")}),null!=e&&Object(i.delay)(e,500)):"function"==typeof e&&e(),Object(i.delay)(function(){return t.$el.hide()},500)}},{key:"visible",value:function(){return!this.$el.hasClass("hidden")}}],[{key:"initClass",value:function(){this.prototype.className="yet-another-spinner"}}]),t}()).initClass(),a=a)},168:function(e,t,n){var i={"./en-au":94,"./en-au.js":94,"./en-ca":93,"./en-ca.js":93,"./en-gb":92,"./en-gb.js":92,"./en-ie":91,"./en-ie.js":91,"./en-il":90,"./en-il.js":90,"./en-nz":89,"./en-nz.js":89};function r(e){var t=o(e);return n(t)}function o(e){var t=i[e];if(!(t+1)){var n=new Error('Cannot find module "'+e+'".');throw n.code="MODULE_NOT_FOUND",n}return t}r.keys=function(){return Object.keys(i)},r.resolve=o,e.exports=r,r.id=168},178:function(e,t,n){"use strict";var i=n(0),r=n.n(i),o=n(1),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.receiveHeight=this.receiveHeight.bind(this),this.id=t,window.addEventListener("message",this.receiveHeight)}return a(e,[{key:"receiveHeight",value:function(e){if("https://datawrapper.dwcdn.net"===(e.origin||e.originalEvent.origin)){var t=e.data["datawrapper-height"];if(null!=t)return this.setHeight(t[this.id])}}},{key:"setHeight",value:function(e){return r()("#"+this.id).height(e)}}]),e}(),l=n(83),u=n(84),c=n.n(u),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var f=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scrollToChildPosMessage=this.scrollToChildPosMessage.bind(this),null==i&&(i={});var o=r()("#"+t);this.responsiveId="responsive-"+t,this.url=n,this.offset=parseInt(i.offset||0),this.height=parseInt(i.height||400),o.hide(),o.before("<div id='"+this.responsiveId+"'></div>");var a=new c.a.Parent(this.responsiveId,n,{});a.iframe.setAttribute("height",this.height+"px"),a.onMessage("saveScrollPosition",this.saveScrollPosition),a.onMessage("revertScrollPosition",this.revertScrollPosition),a.onMessage("scrollToChildPos",this.scrollToChildPosMessage)}return p(e,[{key:"scrollToChildPosMessage",value:function(e){var t=document.getElementById(this.responsiveId).getBoundingClientRect().top+window.pageYOffset-this.offset+parseInt(e);return window.scrollTo(0,t)}},{key:"saveScrollPosition",value:function(){return this.lastScrollPosition=l.a.scrollYPosition()}},{key:"revertScrollPosition",value:function(){return window.scrollTo(0,this.lastScrollPosition)}}]),e}();t.a={init:function(e,t){var n=this;null==t&&(t={}),this.offset=t.offset||0;var i=e.find("iframe.tc-infographic");Object(o.each)(i,function(e,t){var i=r()(e).attr("id"),o=r()(e).attr("src"),a=r()(e).attr("height");return new f(i,o,{offset:n.offset,height:a})});var a=e.find("iframe.tc-infographic-datawrapper");return Object(o.each)(a,function(e,t){var n=r()(e).attr("id");return new s(n)})}}},179:function(e,t,n){"use strict";var i=n(2),r=n(6),o=n.n(r),a=n(1),s=n(3),l=n(0),u=n.n(l),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var p=void 0,f=((p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),c(t,[{key:"initialize",value:function(e){return this.render=this.render.bind(this),this.daySelect=this.daySelect.bind(this),this._setMonthSelectOptions=this._setMonthSelectOptions.bind(this),this._fillYearSelect=this._fillYearSelect.bind(this),this.startDate=e.startDate,this.calendarMoment=o()(e.displayDate),this.endDate=e.endDate,this.rangeStart=e.rangeStart,this.rangeEnd=e.rangeEnd,this.allowableDateRange={start:o()(this.rangeStart),end:o()(this.rangeEnd)},this.message=e.message,this.render()}},{key:"render",value:function(){return this.$el.html(this.template({month:this.calendarMoment.format("MMMM, YYYY"),message:this.message})),this.monthsEl=this.$el.find(".months"),this.monthDataEl=u()("<div class='month-data'></div>"),this.$el.append(this.monthDataEl),this.renderMonthSelector(),this.renderMonthData(),this.monthSelectEl=this.$el.find("select[name='month']"),this.yearSelectEl=this.$el.find("select[name='year']"),this._refreshCalendarInterface(this.allowableDateRange)}},{key:"renderMonthSelector",value:function(){return this.previousMonth=this.monthsEl.find(".previous-month"),this.nextMonth=this.monthsEl.find(".next-month"),this.calendarMoment.format("YYYY-MM")===o()(this.startOfTime).format("YYYY-MM")?this.previousMonth.addClass("current"):this.previousMonth.removeClass("current"),this.calendarMoment.format("YYYY-MM")===o()(this.rangeStart).format("YYYY-MM")?this.previousMonth.addClass("current"):this.previousMonth.removeClass("current"),this.calendarMoment.format("YYYY-MM")===o()(this.rangeEnd).format("YYYY-MM")?this.nextMonth.addClass("current"):this.nextMonth.removeClass("current")}},{key:"renderMonthData",value:function(){return this.monthDataEl.html(this.monthData({weeks:this._weekDataForCalendarMonth(this.calendarMoment,this.rangeStart,this.rangeEnd),rangeStart:this.rangeStart,rangeEnd:this.rangeEnd,startDate:this.startDate,endDate:this.endDate}))}},{key:"_setCalendarMonth",value:function(e){return e.preventDefault(),this.calendarMoment.month(parseInt(u()(e.target).val())),this.transitionMonth()}},{key:"_setCalendarYear",value:function(e){return e.preventDefault(),this.calendarMoment.year(u()(e.target).val()),this.transitionMonth()}},{key:"_decrementCalendarMonth",value:function(e){return e.preventDefault(),this.calendarMoment.subtract(1,"months"),this.transitionMonth()}},{key:"_incrementCalendarMonth",value:function(e){return e.preventDefault(),this.calendarMoment.add("months",1),this.transitionMonth()}},{key:"_refreshCalendarInterface",value:function(){return this._fillYearSelect(this.allowableDateRange),this._setMonthSelectOptions(this.calendarMoment,this.allowableDateRange),this.monthSelectEl.val(""+this.calendarMoment.month()),this.yearSelectEl.val(""+this.calendarMoment.year())}},{key:"_constrainCalendarMomentToAllowableRange",value:function(){return this.calendarMoment=o.a.max(this.allowableDateRange.start,this.calendarMoment).clone(),this.calendarMoment=o.a.min(this.allowableDateRange.end,this.calendarMoment).clone()}},{key:"transitionMonth",value:function(){return this._constrainCalendarMomentToAllowableRange(),this._refreshCalendarInterface(),this.monthDataEl.remove(),this.renderMonthSelector(),this.monthDataEl=u()("<div class='month-data'></div>"),this.$el.append(this.monthDataEl),this.renderMonthData()}},{key:"_weekDataForCalendarMonth",value:function(e,t,n){var i=[],r=o()(e).startOf("month"),a=o()(e).endOf("month"),s=o()(e).startOf("month");for(i.push(this._paddedDaysOfWeek(s,a,r));s.isBefore(a);)s.add("weeks",1),i.push(this._paddedDaysOfWeek(s,a,r));return i}},{key:"_paddedDaysOfWeek",value:function(e,t,n){var i=[],r=e.clone();for(r.subtract(r.day(),"days");i.length<7;)r.isBefore(n)||r.isAfter(t)?i.push(""):i.push(r.clone()),r.add("days",1);return i}},{key:"updateRangeStartDate",value:function(e){return this.rangeStart=e,this.allowableDateRange={start:o()(this.rangeStart),end:o()(this.rangeEnd)},o()(e).isAfter(this.calendarMoment)&&(this.calendarMoment=o()(e)),Object(a.delay)(this.render,250)}},{key:"updateStartDate",value:function(e){return this.startDate=e}},{key:"updateEndDate",value:function(e){return this.endDate=e}},{key:"daySelect",value:function(e){if(e.preventDefault(),!u()(e.currentTarget).closest(".out-of-range").length){this.$(".selected").removeClass("selected-day");var t=u()(e.currentTarget);t.closest("li").addClass("selected-day");var n=t.data("date");return this.trigger("update_date",n)}}},{key:"_setMonthSelectOptions",value:function(e,t){var n=void 0,i=void 0;n=o()(e).year()===t.start.year()?t.start.month():0,i=o()(e).year()===t.end.year()?t.end.month():11;for(var r="";n<=i;){var a=o()().month(n);r+='<option value="'+a.month()+'">'+a.format("MMMM")+"</option>",n++}return this.monthSelectEl.html(r)}},{key:"_fillYearSelect",value:function(e){for(var t=e.start.year(),n=e.end.year(),i="";t<=n;)i+='<option value="'+t+'">'+t+"</option>",t++;return this.yearSelectEl.html(i)}}],[{key:"initClass",value:function(){this.prototype.className="calendar",this.prototype.events={"click .previous-month":"_decrementCalendarMonth","click .next-month":"_incrementCalendarMonth","click .day a":"daySelect","change select[name='month']":"_setCalendarMonth","change select[name='year']":"_setCalendarYear"},this.prototype.startOfTime="2011-03-25",this.prototype.template=Object(a.template)('<div class="calendar-view-header">\n  <span><%- message %></span>\n</div>\n<div class="months">\n  <a href="#" class="previous-month"><i class="icon-caret-left"></i></a>\n  <p class="selected-date">\n    <span class="month">\n      <select name="month"></select>\n    </span>\n    <span class="year">\n      <select name="year"></select>\n    </span>\n  </p>\n  <a href="#" class="next-month"><i class="icon-caret-right"></i></a>\n</div>'),this.prototype.monthData=Object(a.template)('<ol class="days">\n  <li><%= i18n.t(\'calendar.label.day_abbreviation.sunday\') %></li>\n  <li><%= i18n.t(\'calendar.label.day_abbreviation.monday\') %></li>\n  <li><%= i18n.t(\'calendar.label.day_abbreviation.tuesday\') %></li>\n  <li><%= i18n.t(\'calendar.label.day_abbreviation.wednesday\') %></li>\n  <li><%= i18n.t(\'calendar.label.day_abbreviation.thursday\') %></li>\n  <li><%= i18n.t(\'calendar.label.day_abbreviation.friday\') %></li>\n  <li><%= i18n.t(\'calendar.label.day_abbreviation.saturday\') %></li>\n</ol>\n<% _.each(weeks, function(week, index) {%>\n  <ol class="week">\n    <% _.each(week, function(day, index) {%>\n      <% if (day && day !== "") { %>\n        <%\n          dayClass = "day ";\n          if (day.isAfter(startDate) && day.isBefore(endDate)) {\n            dayClass += " within-range";\n          }\n\n          if (day.isBefore(rangeStart) || day.isAfter(rangeEnd)) {\n            dayClass += " out-of-range";\n          }\n        %>\n\n        <li class="<%- dayClass %>">\n          <span><a href="#" data-date="<%- day.format("YYYY-MM-DD") %>">\n             <%- day.format("D") %></span>\n          </a>\n        </li>\n\n      <% } else { %>\n        <li class="empty">\n          &nbsp;\n        </li>\n        <% } %>\n      </li>\n    <% }); %>\n  </ol>\n<% }); %>',{imports:{i18n:i.a}})}}]),t}()).initClass(),p=p),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var d=void 0,m=((d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),h(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.startDate=e.startDate,this.endDate=e.endDate,this.render(),this.startDateEl=this.$el.find(".start-date"),this.endDateEl=this.$el.find(".end-date")}},{key:"render",value:function(){return this.$el.html(this.template({startDate:this.startDate,endDate:this.endDate}))}},{key:"setStartDate",value:function(e){return this.startDateEl.html(o()(e).format("MMMM Do YYYY"))}},{key:"setEndDate",value:function(e){return this.endDateEl.html(o()(e).format("MMMM Do YYYY"))}},{key:"_handleDone",value:function(e){return e.preventDefault(),this.trigger("done")}},{key:"_handleCancel",value:function(e){return e.preventDefault(),this.trigger("cancel")}}],[{key:"initClass",value:function(){this.prototype.className="custom-date-range-confirmation-view",this.prototype.events={"click .cancel":"_handleCancel","click .done":"_handleDone"},this.prototype.template=Object(a.template)('<div class="calendar-view-header">\n  <a href="#" class="cancel"><%= i18n.t(\'calendar.button.cancel\') %></a>\n  <a href="#" class="done"><%= i18n.t(\'calendar.button.done\') %></a>\n</div>\n<div class="selected-dates">\n  <h2><%= i18n.t(\'calendar.label.ranges.starting_from\') %></h2>\n  <div class="start-date"><%- startDate %></div>\n\n  <h2><%= i18n.t(\'calendar.label.ranges.ending_at\') %></h2>\n  <div class="end-date"><%- endDate %></div>\n</div>',{imports:{i18n:i.a}})}}]),t}()).initClass(),d=d),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var b=void 0;t.a=((b=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),y(t,[{key:"initialize",value:function(e){return this.startDate=e.startDate,this.endDate=e.endDate,this.render()}},{key:"render",value:function(){var e=this;return this.$el.html(this.template),this.calendarsEl=this.$el.find(".calendar-container"),this.startDateEl=this.$el.find(".start-date"),this.startCalendar=new f({startDate:o()(this.startDate).format("YYYY-MM-DD"),displayDate:o()(this.startDate),endDate:o()(this.endDate).format("YYYY-MM-DD"),rangeStart:this.startOfTime,rangeEnd:o()(),message:i.a.t("calendar.label.select_start_date")}),this.startCalendar.$el.appendTo(this.calendarsEl),this.startCalendar.bind("update_date",function(t){return Object(a.delay)(function(){return e.displayEndDateCalendar()},500),e.startCalendar.updateStartDate(t),e.endCalendar.updateRangeStartDate(t),e.endCalendar.updateStartDate(t),e.confirmationView.setStartDate(t),e.setStartDate(t)}),this.endDateEl=this.$el.find(".end-date"),this.endCalendar=new f({startDate:o()(this.startDate).format("YYYY-MM-DD"),displayDate:this.endDate,endDate:o()(this.endDate).format("YYYY-MM-DD"),rangeStart:o()(this.startDate),rangeEnd:o()(),message:i.a.t("calendar.label.select_end_date")}),this.endCalendar.$el.appendTo(this.calendarsEl),this.endCalendar.bind("update_date",function(t){return Object(a.delay)(function(){return e.displayConfirmationView()},500),e.endCalendar.updateEndDate(t),e.confirmationView.setEndDate(t),e.setEndDate(t)}),this.confirmationView=new m({startDate:o()(this.startDate).format("MMMM Do YYYY"),endDate:o()(this.endDate).format("MMMM Do YYYY")}),this.confirmationView.$el.appendTo(this.calendarsEl),this.confirmationView.on("done",function(){var t=o()(e.startDate).format("YYYY-MM-DD"),n=o()(e.endDate).format("YYYY-MM-DD");return e.trigger("update_date_range",t,n)}),this.confirmationView.on("cancel",function(){return e.trigger("cancel_date_pick")})}},{key:"setStartDate",value:function(e){if(e!==this.startDate)return this.dirty=!0,this.startDate=e}},{key:"setEndDate",value:function(e){if(e!==this.endDate)return this.dirty=!0,this.endDate=e}},{key:"openStartDateCalendar",value:function(e){return e.preventDefault(),this.displayStartDateCalendar()}},{key:"displayStartDateCalendar",value:function(){return this.$el.addClass("open-start").removeClass("step-2").removeClass("step-3")}},{key:"openEndDateCalendar",value:function(e){return e.preventDefault(),this.displayEndDateCalendar()}},{key:"displayEndDateCalendar",value:function(){return this.$el.removeClass("open-start").addClass("step-2").removeClass("step-3")}},{key:"displayConfirmationView",value:function(){return this.$el.removeClass("open-start").removeClass("step-2").addClass("step-3")}},{key:"makeSelection",value:function(e){e.preventDefault();var t=o()(this.startDate).format("YYYY-MM-DD"),n=o()(this.endDate).format("YYYY-MM-DD");return this.trigger("update_date_range",t,n)}}],[{key:"initClass",value:function(){this.prototype.className="calendars",this.prototype.events={"click .range":"makeSelection","click .start-date-selected":"openStartDateCalendar","click .end-date-selected":"openEndDateCalendar"},this.prototype.startOfTime="2011-03-25",this.prototype.template=Object(a.template)('<div class="calendar-container"></div>')}}]),t}()).initClass(),b=b)},182:function(e,t,n){"use strict";var i=n(4),r=n.n(i),o=n(5),a=n.n(o),s=n(85),l=n.n(s),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClick=n.onClick.bind(n),n.onChange=e.onChange.bind(n),n.state={checked:e.checked},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),c(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({checked:e.checked})}},{key:"onClick",value:function(e){this.setState({checked:e.target.checked})}},{key:"inputId",value:function(){var e=u({},this.props);return[e.name,e.value].join("-")}},{key:"render",value:function(){var e=[this.state.checked,this.props.name,this.props.value,this.props.labelText],t=e[0],n=e[1],i=e[2],o=e[3];return r.a.createElement("label",{htmlFor:this.inputId(),className:l.a.switch},o,r.a.createElement("input",{id:this.inputId(),className:l.a.hidden,name:n,value:i,type:"checkbox",checked:t,onChange:this.onChange,onClick:this.onClick}),r.a.createElement("span",{className:l.a.toggle}))}}]),t}();p.defaultProps={checked:!1,onChange:function(){},labelText:""},p.propTypes={labelText:a.a.string,checked:a.a.bool,name:a.a.string.isRequired,onChange:a.a.func,value:a.a.oneOfType([a.a.string,a.a.number]).isRequired},t.a=p},183:function(e,t,n){var i=n(220);"string"==typeof i&&(i=[[e.i,i,""]]);var r={transform:void 0};n(21)(i,r);i.locals&&(e.exports=i.locals)},184:function(e,t,n){"use strict";var i=n(5),r=n.n(i),o=n(4),a=n.n(o),s=n(183),l=n.n(s),u=function(e){var t=e.enabled,n=e.title;return t?a.a.createElement("span",{className:l.a.loader,title:n}):null};u.defaultProps={enabled:!0,title:"Loading"},u.propTypes={enabled:r.a.bool,title:r.a.string},t.a=u},189:function(e,t,n){"use strict";var i=n(4),r=n.n(i),o=n(18),a=n.n(o),s=n(188),l=n(187),u=function(e,t,n){Array.from(e.querySelectorAll("[data-react-class="+n+"]")).forEach(function(e){var n=JSON.parse(e.dataset.reactProps),i=r.a.createElement(t,n);a.a.render(i,e)})};t.a=function(e){u(e,s.Tweet,"Tweet"),u(e,l.a,"InstagramEmbed")}},19:function(e,t,n){"use strict";var i=n(0),r=n.n(i),o=n(3),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var s=void 0;t.a=((s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.View),a(t,[{key:"initialize",value:function(e){return this._click=this._click.bind(this),r()(this.el).on("click",this._click)}},{key:"disabled",value:function(e,t){null==t&&(t=!1);var n=r()(this.el).hasClass("disabled");return null!=e&&e!==n?(r()(this.el).toggleClass("disabled",e),t||this.trigger("change:disabled",this,e),e):n}},{key:"state",value:function(e,t){null==t&&(t=!1);var n=r()(this.el).hasClass("on");return null!=e&&e!==n?(r()(this.el).toggleClass("on",e),t||this.trigger("change:state",this,e),e):n}},{key:"visible",value:function(e,t){null==t&&(t=!1);var n=r()(this.el).is(":visible");return null!=e?(e?r()(this.el).show():r()(this.el).hide(),t||e===n||this.trigger("change:visible",this,e),e):n}},{key:"hide",value:function(){return this.visible(!1)}},{key:"show",value:function(){return this.visible(!0)}},{key:"toggleEnabled",value:function(){var e=this.disabled();return this.disabled(!e)}},{key:"toggleState",value:function(){var e=this.state();return this.state(!e)}},{key:"_click",value:function(e){if(e){var t=r()(e.target).attr("href");t&&"#"===t&&e.preventDefault()}if(!this.disabled())return this.trigger("click",this,e)}}],[{key:"initClass",value:function(){this.prototype.delay=5e3}}]),t}()).initClass(),s=s)},191:function(e,t,n){"use strict";var i=n(0),r=n.n(i),o=n(190),a=n.n(o),s=n(15),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.a=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.showImagebox=this.showImagebox.bind(this),r()(t).append('<div class="enlarge_hint"></div>').click(function(e){return e.preventDefault(),n.showImagebox(r()(e.currentTarget)[0].href)})}return l(e,[{key:"loadImage",value:function(e,t){var n=r()(new Image);return n.attr("src",e),a()(n,function(){return n.appendTo("body").hide().data("dimensions",{x:n.width(),y:n.height()}),t(n)})}},{key:"showImagebox",value:function(e){var t=this;return r()("div.imagebox").remove(),r()("<div />").addClass("imagebox").appendTo("body").click(function(){return r()(this).remove()}),new s.a({centered:!0,size:"50px"}).$el.appendTo(r()("body div.imagebox")),this.loadImage(e,function(e){return r()("div.imagebox").html(e.addClass("appearing").show()).click(function(){return r()(window).unbind("resize",this.positionImagebox)}),setTimeout(function(){return r()("div.imagebox img").removeClass("appearing")},10),t.positionImagebox(),r()(window).resize(t.positionImagebox)})}},{key:"positionImagebox",value:function(){var e=r()("div.imagebox img"),t=e.data("dimensions"),n={x:r()(window).width()-18-18,y:r()(window).height()-18-18},i=t.x/t.y,o=n.x/n.y,a=i>=o?n.x:n.x*i/o;return a>t.x&&(a=t.x),e.css({width:a+"px",left:Math.max(18,18+(n.x-a)/2)+"px",top:Math.max(18,18+(n.y-a/i)/2)+"px"})}}]),e}()},2:function(e,t,n){"use strict";var i=n(25),r=n(55),o=n.n(r),a=n(28),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return s(e,null,[{key:"init",value:function(e,t,n,r){i.a.use(o.a).init({backend:{loadPath:e,crossDomain:n},lng:t},function(e){e&&e.length&&Object(a.a)("/no_js_locale?message="+e[0]);try{r()}catch(e){throw Object(a.a)("/js_init_failure?message="+e),e}})}},{key:"t",value:function(){return i.a.t.apply(i.a,arguments)||(arguments.length<=0?void 0:arguments[0])}}]),e}();t.a=l},204:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(8),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var s=void 0;t.default=((s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),a(t,[{key:"initialize",value:function(e){if(function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.countrySelector=r()("#event_country"),this.stateSelector=r()("#event_state"),!this.country())return this.disableStateSelector()}},{key:"changeCountry",value:function(e){return this.disableStateSelector(),this.country()?this.updateStateSelector():this.clearStateSelector()}},{key:"clearStateSelector",value:function(){return this.stateSelector.children("option").remove()}},{key:"country",value:function(){return this.countrySelector.children("option:selected").text()}},{key:"disableStateSelector",value:function(){return this.stateSelector.attr("disabled",!0)}},{key:"enableStateSelector",value:function(){return this.stateSelector.attr("disabled",!1)}},{key:"updateStateSelector",value:function(){var e=this,t=r()("#user_selected_event_state").val();return r.a.ajax({type:"GET",url:"/countries/"+this.country()+"/states",dataType:"json",success:function(n){return e.clearStateSelector(),e.enableStateSelector(),function(){var i=[];for(var o in n){var a=n[o],s=r()("<option>").attr({value:o}).text(a.name);o===t&&s.prop("selected",!0),i.push(s.appendTo(e.stateSelector))}return i}()}})}}],[{key:"initClass",value:function(){this.prototype.events={"change #event_country":"changeCountry"}}}]),t}()).initClass(),s=s)},208:function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=void 0;t.a=((r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,null,[{key:"initClass",value:function(){this.list=["Adjunct assistant professor","Adjunct associate","Adjunct professor","Assistant lecturer","Assistant professor emeritus","Assistant researcher","Assistant scientist","Associate dean","Associate lecturer","Associate professor","Associate professor emeritus","Associate research scientist","Chair professor","Chancellor","Chief executive officer","Clinical assistant professor","Clinical associate professor","Clinical professor","Course coordinator","Dean","Dean of faculties","Deputy Principal","Deputy chancellor","Deputy vice-chancellor","Emeritus professor","Emeritus reader","Faculty dean","Faculty deputy dean","Fellow","Head of department","Head of school","Instructor","Junior scientist","Lecturer","Postdoctoral associate","Postdoctoral fellow","Postdoctoral research associate","Postdoctoral research fellow","Principal","Pro-vice-chancellor","Professor","Professor emeritus","Professorial fellow","Program director","Provost","Reader","Rector","Registrar","Research assistant","Research assistant professor","Research associate","Research associate professor","Research fellow","Research officer","Research professor","Research scientist","Senior fellow","Senior lecturer","Senior research associate","Senior research fellow","Senior research scientist","Senior research technician","Senior scientist","Senior tutor","Tutor","Vice chancellor","Vice-principal","Visiting assistant professor","Visiting associate professor","Visiting professor","Visitor"]}}]),e}()).initClass(),r=r)},209:function(e,t,n){"use strict";var i=n(27),r=n.n(i),o=n(1),a=n(3),s=n(48),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["View"]),l(t,[{key:"initialize",value:function(){this.cookie="au_donation_bar_may_2018",this.donationParams="utm_source=theconversation.com&utm_medium=banner&utm_campaign=au-donation-2018-eofy",this.donationUrl=["https://donate.theconversation.com/au",this.donationParams].join("?"),this.render(),this.$el.find(".close-and-do-not-show-again").on("click",this.hideAndDontShowAgain.bind(this)),this.$el.find(".donate").on("click",this.makeDonation.bind(this))}},{key:"render",value:function(){r()(this.cookie)||(s.default.track("Donation Banner","Impression","TCAU EOFY 2018 Campaign"),this.$el.html(this.template({donationUrl:this.donationUrl})))}},{key:"makeDonation",value:function(e){e.preventDefault();var t=e.currentTarget.href;r.a.set(this.cookie,"true",{expires:6e3}),window.location=t}},{key:"hideAndDontShowAgain",value:function(e){e.preventDefault(),this.$el.remove(),s.default.track("Donation Banner","Opt-out","TCAU EOFY 2018 Campaign"),r.a.set(this.cookie,"true",{expires:6e3})}}],[{key:"initClass",value:function(){this.prototype.tagName="section",this.prototype.className="au-donation-2018-banner",this.prototype.template=Object(o.template)('\n      <div class="wrapper">\n        <div class="grid-thirteen description">\n          <p>\n            The Conversation is an antidote to alternative facts, bringing you analysis and research from\n            <span class=\'nobr\'>real experts</span>.\n            We are a not-for-profit charity that relies on the support of our readers. <br />\n            If you value our work, please make a donation.\n          </p>\n        </div>\n\n        <div class="actions grid-three grid-last">\n          <a href="<%- this.donationUrl %>" class="donate button subtle">Make a donation</a>\n          <a href="#" class="close-and-do-not-show-again">Don\'t show again <i class="icon-delete"></i></a>\n        </div>\n      </div>')}}]),t}();u.initClass(),t.a=u},210:function(e,t,n){"use strict";var i=n(2),r=n(0),o=n.n(r),a=n(1),s=n(3),l=n(27),u=n.n(l),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var p=void 0;t.a=((p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),c(t,[{key:"initialize",value:function(e){if(this.cookieName="topbar-mobile-newsletter-signup-july-2015",!u.a.get(this.cookieName))return this.render()}},{key:"render",value:function(){return this.$el.html(this.template({newsletterUrl:this._newsletterUrl()}))}},{key:"_subscribe",value:function(e){return e.preventDefault(),TC.analytics.track("Newsletter subscription - Mobile topbar",document.location.pathname,"",1),u.a.set(this.cookieName,"true",{expires:6e3}),window.location=o()(e.currentTarget).attr("href")}},{key:"_hideAndDontShowAgain",value:function(e){return e.preventDefault(),this.$el.remove(),u.a.set(this.cookieName,"true",{expires:6e3})}},{key:"_newsletterUrl",value:function(){return"https://theconversation.com/newsletter"}}],[{key:"initClass",value:function(){this.prototype.events={"click .close":"_hideAndDontShowAgain","click .topbar-mobile-newsletter-signup-subscribe":"_subscribe"},this.prototype.template=Object(a.template)('<section class="topbar-mobile-newsletter-signup">\n  <a href="<%- newsletterUrl %>" class="topbar-mobile-newsletter-signup-subscribe">\n    <i class="icon-email"></i>\n    <span class="topbar-button-text"><%- i18n.t(\'topbar.mobile_newsletter_signup.button\') %></span>\n  </a>\n\n  <a href="#" class="close"><i class="icon-delete"></i></a>\n</section>',{imports:{i18n:i.a}})}}]),t}()).initClass(),p=p)},219:function(e,t,n){(t=e.exports=n(22)(!1)).push([e.i,'.hidden-1nLxb {\n  display: none; }\n\n.switch-2ZlR2 {\n  position: relative;\n  display: inline-block;\n  padding-right: 70px;\n  height: 25px;\n  line-height: 25px;\n  font-weight: bold; }\n\n.toggle-3nSDc {\n  background-color: #fafafa;\n  -webkit-border-radius: 34px;\n  border-radius: 34px;\n  cursor: pointer;\n  position: absolute;\n  -webkit-transition: 0.4s;\n  -o-transition: 0.4s;\n  transition: 0.4s;\n  border: 1px solid #ccc;\n  -webkit-border-radius: 20px;\n  border-radius: 20px;\n  width: 60px;\n  bottom: 0;\n  right: 0;\n  top: 0; }\n\n.toggle-3nSDc:before {\n  background-color: #FFF;\n  -webkit-border-radius: 25px;\n  border-radius: 25px;\n  content: "";\n  position: absolute;\n  -webkit-transition: 0.4s;\n  -o-transition: 0.4s;\n  transition: 0.4s;\n  -webkit-box-shadow: 0 1px 4px rgba(0, 0, 0, 0.25);\n  box-shadow: 0 1px 4px rgba(0, 0, 0, 0.25);\n  border: 1px solid #ccc;\n  bottom: -2px;\n  height: 25px;\n  left: -2px;\n  width: 25px; }\n\ninput:checked + .toggle-3nSDc {\n  background-color: #00be00;\n  border: 1px solid #00be00; }\n\ninput:checked + .toggle-3nSDc:before {\n  -webkit-transform: translateX(39px);\n  -ms-transform: translateX(39px);\n  transform: translateX(39px); }\n',""]),t.locals={hidden:"hidden-1nLxb",switch:"switch-2ZlR2",toggle:"toggle-3nSDc"}},220:function(e,t,n){(t=e.exports=n(22)(!1)).push([e.i,"@-webkit-keyframes spin-3ZV1o {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg); }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg); } }\n\n@keyframes spin-3ZV1o {\n  0% {\n    -webkit-transform: rotate(0deg);\n    transform: rotate(0deg); }\n  100% {\n    -webkit-transform: rotate(360deg);\n    transform: rotate(360deg); } }\n\n.loader-Tjd3L {\n  -webkit-animation: spin-3ZV1o 0.8s infinite linear;\n  animation: spin-3ZV1o 0.8s infinite linear;\n  display: block;\n  width: 12px;\n  height: 12px;\n  margin: 0 auto;\n  border: 3px solid #d9f3fc;\n  border-top: 3px solid #33bef2;\n  -webkit-border-radius: 50%;\n  border-radius: 50%;\n  -webkit-transform-origin: 50% 50%;\n  -ms-transform-origin: 50% 50%;\n  transform-origin: 50% 50%;\n  -webkit-transition: opacity 500ms;\n  -o-transition: opacity 500ms;\n  transition: opacity 500ms; }\n",""]),t.locals={loader:"loader-Tjd3L",spin:"spin-3ZV1o"}},28:function(e,t,n){"use strict";t.a=function(e){var t=!1;window.XMLHttpRequest?t=new XMLHttpRequest:window.ActiveXObject&&(t=new ActiveXObject("Microsoft.XMLHTTP")),!1!==t&&(t.open("GET",e,!0),t.send())}},334:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(8),a=n(134),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.default=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["default"]),s(t,[{key:"initialize",value:function(e){return new a.a({el:r()("body")}),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}}]),t}()},337:function(e,t,n){var i=n(840);"string"==typeof i&&(i=[[e.i,i,""]]);var r={transform:void 0};n(21)(i,r);i.locals&&(e.exports=i.locals)},378:function(e,t,n){var i=n(842);"string"==typeof i&&(i=[[e.i,i,""]]);var r={transform:void 0};n(21)(i,r);i.locals&&(e.exports=i.locals)},380:function(e,t,n){"use strict";n.r(t);var i=n(8),r=n(2),o=n(0),a=n.n(o),s=n(1),l=n(9),u=n.n(l),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var d=function(){function e(){h(this,e),this.steps=[],this.current_step_index=0,this.steps_container=a()("#form-steps"),this.build_steps(),this.attach_subscribers()}return c(e,[{key:"serialise_to_json",value:function(){var e={},t=!0,n=!1,i=void 0;try{for(var r,o=Array.from(this.steps)[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value.serialise_to_json();for(var s in a){var l=a[s];e[s]=l}}}catch(e){n=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(n)throw i}}return{author:e}}},{key:"build_steps",value:function(){return this.steps.push(new y(this.steps.length)),this.steps.push(new b(this.steps.length)),this.steps.push(new v(this.steps.length))}},{key:"has_previous_step",value:function(e){return e>0&&e<this.steps.length}},{key:"previous_step",value:function(e){return!!this.has_previous_step(e)&&this.steps[e-1]}},{key:"is_last_step",value:function(e){return e+1===this.steps.length}},{key:"attach_subscribers",value:function(){var e=this;return u.a.subscribe("/data-submission/from",function(t){return a.a.ajax({type:"POST",url:e.is_last_step(t)?"/become-an-author":"/become-an-author?dry_run=true",data:e.serialise_to_json(),dataType:"json",success:function(n){return e.steps[t].restore_submit_button(),n.errors&&!e.steps[t].is_valid(n.errors)?e.steps[t].show_errors(n.errors):e.is_last_step(t)?document.location=n.redirect:(e.steps[t].hide_errors(),u.a.publish("/step-change/to",[t+1]))},error:function(){return e.steps[t].restore_submit_button()}})}),u.a.subscribe("/step-change/to",function(t){if(t>=0&&t<e.steps.length)return e.current_step_index=t,a()("#form-steps").removeClass("stepped-1 stepped-2"),a()("#form-steps").addClass("stepped-"+e.current_step_index)})}}]),e}(),m=function(){function e(t){var n=this;h(this,e),this.index=t,this.form=a()(a()("#form-steps form")[this.index]),this.submit_button=this.form.find("input[type=submit]"),this.nav=a()(a()("#nav-steps li")[this.index]),this.form.submit(function(){return n.disable_submit_button(),u.a.publish("/data-submission/from",[n.index]),!1}),this.nav.click(function(){if(n.nav.hasClass("navigable"))return u.a.publish("/step-change/to",[n.index])}),this.attach_subscribers()}return c(e,[{key:"current_step",value:function(){return this.nav.hasClass("on")}},{key:"nav_on",value:function(){return this.nav.addClass("on")}},{key:"nav_off",value:function(){return this.nav.removeClass("on")}},{key:"nav_clickable",value:function(){return this.nav.addClass("navigable")}},{key:"nav_not_clickable",value:function(){return this.nav.removeClass("navigable")}},{key:"disable_submit_button",value:function(){return this.submit_button.val("Processing ...").attr("disabled","disabled").addClass("disabled")}},{key:"restore_submit_button",value:function(){return this.submit_button.val(this.submit_button.data("original-text")).removeAttr("disabled").removeClass("disabled")}},{key:"text_field",value:function(e){return this.form.find(e).first().val()}},{key:"attach_subscribers",value:function(){var e=this;return u.a.subscribe("/step-change/to",function(t){return t===e.index?e.nav_on():e.nav_off(),e.index<t?e.nav_clickable():e.nav_not_clickable()})}},{key:"is_valid",value:function(e){var t=!0,n=!0,i=!1,r=void 0;try{for(var o,a=Array.from(this.fields)[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){null!=e[o.value]&&(t=!1)}}catch(e){i=!0,r=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw r}}return t}},{key:"show_errors",value:function(e){var t=this;return this.hide_errors(),function(){var n=[],i=!0,r=!1,o=void 0;try{for(var s,l=Array.from(t.fields)[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;if(e[u]){var c=a()("input[name='registration_form["+u+"]'], select[name='registration_form["+u+"]']");c.parent().addClass("error"),c.parent().append("<p class='inline-errors'></p>");var p=c.siblings(".inline-errors");p.html(e[u]),n.push(p.show())}else n.push(void 0)}}catch(e){r=!0,o=e}finally{try{!i&&l.return&&l.return()}finally{if(r)throw o}}return n}()}},{key:"hide_errors",value:function(){return this.form.find("li.error").removeClass("error"),this.form.find("p.inline-errors").each(function(e,t){return a()(t).remove()})}}]),e}(),y=function(e){function t(e){h(this,t);var n=p(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),i=Object(s.debounce)(n.autodetectInstitution.bind(n),500);return n.autodetectRequest=null,a()("#registration_form_email").keyup(i),a()("#registration_form_email").change(n.autodetectInstitution.bind(n)),n}return f(t,m),c(t,null,[{key:"initClass",value:function(){this.prototype.fields=["email","institution_name","byline_title","full_name"]}}]),c(t,[{key:"serialise_to_json",value:function(){return{email:this.text_field("#registration_form_email"),institution_name:this.text_field("#registration_form_institution_name"),full_name:this.text_field("#registration_form_full_name"),byline_title:this.text_field("#registration_form_byline_title")}}},{key:"autodetectInstitution",value:function(){null!==this.autodetectRequest&&this.autodetectRequest.abort();var e=a()("#registration_form_email").val().toLowerCase().split("@"),t=e[e.length-1],n=a()("#registration_form_institution_name_input"),i=a()(".institution-details");this.autodetectRequest=a.a.ajax({url:"/institutions/matching",data:{domain:t},method:"GET",success:function(e){var t,o;e.length>0?(t=e[0].label,o=e[0].institution.logo_url,n.find(".inline-errors").hide(),n.find("input").val(t),i.html("<img src='"+o+"' <p>"+t+"</p>"),u.a.publish("/institution-name/change")):(n.find(".inline-errors").show(),n.find("input").val(""),i.html(r.a.t("author_registration.error.couldnt_match_domain_to_institution")),u.a.publish("/institution-name/change"))}})}}]),t}();y.initClass();var b=function(e){function t(){return h(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,m),c(t,[{key:"serialise_to_json",value:function(){return{education_year:this.text_field("#registration_form_education_year"),education_award:this.text_field("#registration_form_education_award"),education_institution:this.text_field("#registration_form_education_institution"),summary:this.text_field("#registration_form_summary")}}}],[{key:"initClass",value:function(){this.prototype.fields=["education_year","education_award","education_institution"]}}]),t}();b.initClass();var v=function(e){function t(){return h(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return f(t,m),c(t,[{key:"serialise_to_json",value:function(){return{password:this.text_field("#registration_form_password"),password_confirmation:this.text_field("#registration_form_password_confirmation"),secondary_email:this.text_field("#registration_form_secondary_email")}}}],[{key:"initClass",value:function(){this.prototype.fields=["password","password_confirmation","secondary_email"]}}]),t}();v.initClass();var _=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.default=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["default"]),_(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.signup=new d}}]),t}()},381:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(57),a=n(134),s=n(210),l={hideAndCloseGallery:function(e){return r()(e).append('<a href="#" class="button close-gallery">Close</a>')},loadGallery:function(e){return this.injectGallery(),r()(".gallery-content-inner").on("load",e+" .expandomatic",function(){r()(".gallery-content-inner").append('<a href="#" class="button close-gallery">Close</a>');return setTimeout(function(){return r()(".gallery-cover, .gallery-content").removeClass("hidden loading")},10)})},injectGallery:function(){return r()("body").append('<div class="gallery-cover hidden loading"></div>'),r()("body").append('<div class="gallery-content hidden"><div class="gallery-content-inner"><a href="#" class="button close-gallery">Close</a></div></div>')},removeGallery:function(){return r()(".gallery-cover, .gallery-content").remove()},enableScrollForBody:function(){return r()("body").css("overflow","auto")},disableScrollForBody:function(){return r()("body").css("overflow","hidden")}},u=n(8),c=n(209),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var f=void 0;t.default=((f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.default),p(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.topbar.html().match("Sign out")||this._initDynamicContentForCachedPage(),this._initTopbarMobileNewsletterSignup(),this._initGalleryExpansion(),new a.a({el:r()("body")}),this.initDonationBar(),new o.a}},{key:"_clickHandheldTab",value:function(e){e.preventDefault();var t=r()(e.target).attr("href");switch(r()("#tabbed-navigation a.active").removeClass("active"),r()(e.target).addClass("active"),t){case"#analysis":return r()(".page-layout.section").removeClass("handheld-display-research handheld-display-columns"),r()(".page-layout.section").addClass("handheld-display-analysis");case"#research":return r()(".page-layout.section").removeClass("handheld-display-analysis handheld-display-columns"),r()(".page-layout.section").addClass("handheld-display-research");case"#columns":return r()(".page-layout.section").removeClass("handheld-display-analysis handheld-display-research"),r()(".page-layout.section").addClass("handheld-display-columns")}}},{key:"initDonationBar",value:function(){if(this._isAU()){var e=(new c.a).el;this.topbar.after(e)}}},{key:"_initDynamicContentForCachedPage",value:function(){var e=this;return r.a.ajax({url:r()("div.statically-cached-resource").data("dynamic-content-uri"),success:function(t){return t.csrf&&r()("meta[name=csrf-token]").attr("content",t.csrf),t.topbar&&(window.innerShiv&&(t.topbar=innerShiv(t.topbar)),r()("#topbar").replaceWith(t.topbar),e._initTopbarMenu()),t.masthead&&(window.innerShiv&&(t.masthead=innerShiv(t.masthead)),r()("#masthead").replaceWith(t.masthead)),t.editorial_menu&&r()(".editorial-menu").replaceWith(t.editorial_menu),e.$el.addClass("dynamic-content-for-cached-page-loaded")}})}},{key:"_initGalleryExpansion",value:function(){if(this.galleryButton=r()(".expand-gallery"),this.galleryButton.length>0)return this.galleryUrl=this.galleryButton[0].href}},{key:"_loadGallery",value:function(e){return e.preventDefault(),l.loadGallery(this.galleryUrl),l.disableScrollForBody()}},{key:"_closeGallery",value:function(e){return e.stopPropagation(),e.preventDefault(),r()("html, body").stop(),l.removeGallery(),l.enableScrollForBody()}},{key:"_isUS",value:function(){return r()("body").is(".region_us")}},{key:"_isAU",value:function(){return r()("body").is(".region_au")}},{key:"_isFR",value:function(){return r()("body").is(".region_fr")}},{key:"_isUK",value:function(){return r()("body").is(".region_uk")}},{key:"_isGlobal",value:function(){return r()("body").is(".region_global")}},{key:"_initTopbarMobileNewsletterSignup",value:function(){if(this._isHomepage()&&!this._isAU()){var e=new s.a;return this.topbar.after(e.el)}}},{key:"_isHomepage",value:function(){return r()("body").is(".pages-show-home-page")&&!r()("body").is(".pages-edit")}},{key:"_isAfrica",value:function(){return r()("body").is(".region_africa")}},{key:"_isOldIE",value:function(){return r()("html").is(".ie7, .ie8")}},{key:"_trackTwitter",value:function(e){return this.link=r()(e.currentTarget),this._completeTracking("Social Media - clicks to our page","Twitter",link)}},{key:"_trackFaceBook",value:function(e){return this.link=r()(e.currentTarget),this._completeTracking("Social Media - clicks to our page","Facebook",link)}},{key:"_trackLinkedin",value:function(e){return this.link=r()(e.currentTarget),this._completeTracking("Social Media - clicks to our page","Linkedin",link)}},{key:"_completeTracking",value:function(e,t,n){return TC.analytics.track(e,t,n.attr("href"),1)}},{key:"_sectionArticleTracking",value:function(e){var t=r()(e.currentTarget),n=t.parents(".page-layout.section").first().data("name"),i=t.closest("article"),o=i.closest(".page-area, .article-section"),a=i.closest(".article-section"),s=a.attr("id"),l=n+"-"+("0"+(r()(".article-section").index(a)+1)).slice(-2)+"-"+s+"-"+("0"+(a.find(".page-area").index(o)+1)).slice(-2)+"-"+("0"+(o.find("article").index(i)+1)).slice(-2);return this._completeTracking("Home/Section Page - Article clicks by position",l,t)}}],[{key:"initClass",value:function(){this.prototype.events={"click .social-media a.twitter":"_trackTwitter","click .social-media a.facebook":"_trackFaceBook","click .social-media a.linkedin":"_trackLinkedin","click #tabbed-navigation a":"_clickHandheldTab","click .page-layout.section article a":"_sectionArticleTracking","click a.button.expand-gallery":"_loadGallery","click a.button.close-gallery":"_closeGallery"}}}]),t}()).initClass(),f=f)},383:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(1),a=n(8),s=n(3),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["View"]),l(t,[{key:"initialize",value:function(e){var t=this;return this._selectOption=this._selectOption.bind(this),this._documentClick=this._documentClick.bind(this),this._toggleMenu=this._toggleMenu.bind(this),null==e&&(e={}),this.$el.on("click",this._toggleMenu),this.selectedOption=this.$el.find("li.checked"),this.previouslySelectedOption=this.selectedOption,this._updateView(),this.onSelect=e.onSelect,this.$el.find("li").each(function(e,n){return r()(n).on("click",t._selectOption)})}},{key:"restorePreviousOption",value:function(){return this.selectedOption=this.previouslySelectedOption,this._updateView()}},{key:"selectedValue",value:function(){return this.selectedOption.find("input").prop("value")}},{key:"getSelectedLabel",value:function(){return this.selectedOption.find("label").text()}},{key:"setMenuLabelText",value:function(e){return this.$el.find(".menu-button-text").text(e)}},{key:"_selectOption",value:function(e){return this.previouslySelectedOption=this.selectedOption,this.selectedOption=r()(e.currentTarget),this.selectedOption.hasClass("checked")?this.onSelect[this.selectedValue()]?this.onSelect[this.selectedValue()]():void 0:(this._updateView(),this.onSelect[this.selectedValue()]?this.onSelect[this.selectedValue()]():this.onSelect.default())}},{key:"_documentClick",value:function(e){return e.preventDefault(),this._toggleMenu()}},{key:"_toggleMenu",value:function(e){var t=this;return null!=e&&e.preventDefault(),this.$el.toggleClass("open"),this.$el.hasClass("open")?Object(o.defer)(function(){return t.$el.off("click",t._toggleMenu),r()(document).on("click",t._documentClick)}):Object(o.defer)(function(){return t.$el.on("click",t._toggleMenu),r()(document).off("click",t._documentClick)})}},{key:"_updateView",value:function(){return this.setMenuLabelText(this.getSelectedLabel()),this.$el.find("li").removeClass("checked"),this.selectedOption.addClass("checked"),this.selectedOption.find("input").prop("checked",!0)}}]),t}(),c=n(11),p=n(179),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,c["a"]),f(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.dateRangePicker=new p.a({ranges:[]}),this.dateRangePicker.$el.appendTo(this.$el.find(".lightbox-inner")),this.listenTo(this.dateRangePicker,"cancel_date_pick",this._cancel),this.listenTo(this.dateRangePicker,"update_date_range",this._update)}},{key:"_cancel",value:function(){return this.trigger("cancel"),this.close()}},{key:"_update",value:function(e,t){return this.trigger("update",e,t),this.close()}}]),t}(),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.default=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["default"]),d(t,[{key:"initialize",value:function(e){var n=this;return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._showCustomDateSelector=this._showCustomDateSelector.bind(this),this._defaultSelect=this._defaultSelect.bind(this),this._cancelCustomDate=this._cancelCustomDate.bind(this),this._setCustomDate=this._setCustomDate.bind(this),this._normaliseResultUrls(),r()("#search-facets").fadeIn(),r()("#search-facets").children().each(function(e,t){if("search-date-selector"!==t.id)return new u({el:t,onSelect:{default:n._defaultSelect}});if(n.dateMenu=new u({el:t,onSelect:{default:n._defaultSelect,custom:n._showCustomDateSelector}}),"custom"===n.dateMenu.selectedValue()){var i=r()("#filter-date-custom-from").prop("value"),o=r()("#filter-date-custom-to").prop("value");return n._setCustomDateLabel(i,o)}})}},{key:"_showCustomDateSelector",value:function(e){var t=new h;return t.$el.appendTo(this.$el),this.listenTo(t,"update",this._setCustomDate),this.listenTo(t,"cancel",this._cancelCustomDate),this.listenTo(t,"leave",this._cancelCustomDate)}},{key:"_defaultSelect",value:function(e){return this._submit()}},{key:"_cancelCustomDate",value:function(){return this.dateMenu.restorePreviousOption()}},{key:"_setCustomDate",value:function(e,t){return this._setCustomDateLabel(e,t),r()("#filter-date-custom-from").prop("value",e),r()("#filter-date-custom-to").prop("value",t),this._submit()}},{key:"_setCustomDateLabel",value:function(e,t){var n=this.dateMenu.getSelectedLabel();return this.dateMenu.setMenuLabelText(n+": "+e+" – "+t)}},{key:"_submit",value:function(){return r()("#search-results").fadeTo(250,.25),r()("#search_form").submit()}},{key:"_normaliseResultUrls",value:function(){return Object(o.each)(r()(".result h1 a"),function(e){var t=r()(e).attr("href"),n=r()(e).data("original-href");return e.href=n,r()(e).on("mousedown",function(e){return e.target.href=t})}),Object(o.each)(r()("#secondary-results a"),function(e){var t=r()(e).attr("href"),n=r()(e).data("original-href");return e.href=n,r()(e).on("mousedown",function(n){return e.href=t}),r()(e).children().on("mousedown",function(n){return e.href=t})})}}]),t}()},384:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i);navigator.platform.match("Win")&&/WebKit/.test(navigator.userAgent)&&r()(document.body).css("font-family","helvetica, arial, sans-serif");n(964),n(963),n(958),n(957),n(956),n(955),n(954),n(953),n(952),n(951),n(950),n(948),n(947),n(946),n(945),n(944),n(942),n(941),n(940),n(939),n(938),n(937),n(936),n(935),n(934),n(933),n(932),n(931),n(927),n(924),n(923),n(922),n(921),n(920),n(919),n(918),n(917),n(916),n(915),n(914),n(913),n(911),n(910),n(909),n(908),n(907),n(905),n(904),n(903),n(902),n(901),n(899),n(898),n(897),n(896),n(895),n(894),n(893),n(892),n(891),n(890),n(320),n(889),n(888),n(887),n(886),n(885),n(884),n(883),n(882),n(881),n(880),n(879),n(878),n(877),n(876),n(875),n(873),n(872),n(871),n(870),n(869),n(868),n(867),n(866),n(865),n(864),n(863),n(862),n(861),n(860),n(859),n(858),n(857),n(856),n(855),n(854),n(853),n(171),n(110),n(170),n(852);var o=n(3),a=n.n(o),s=n(379),l=n.n(s);r.a.ajaxPrefilter(function(e,t,n){if(!e.crossDomain){var i=r()('meta[name="csrf-token"]').attr("content");i&&n.setRequestHeader("X-CSRF-Token",i)}}),l.a.start(),a.a.$=r.a,n(851)(function(){r()("input[placeholder]").placeholder()}),window.TC.activeAjax=function(){return r.a.active},window.TC.TimeFormatter=n(97).default,window.TC.analytics=n(48).default,window.TC.BasePage=n(8).default,window.TC.ChooserView=n(13).default,window.TC.ColumnPage=n(850).default,window.TC.ContentPage=n(398).default,window.TC.EditPasswordPage=n(849).default,window.TC.EditProfilePage=n(848).default,window.TC.ExpertsPage=n(334).default,window.TC.ExpertsSearchPage=n(389).default,window.TC.InfoPage=n(847).default,window.TC.InstitutionPage=n(846).default,window.TC.NewEventPage=n(204).default,window.TC.NewRegistrationPage=n(380).default,window.TC.NewsletterSubscriptionPage=n(845).default,window.TC.PagePage=n(381).default,window.TC.PodcastsPage=n(844).default,window.TC.ProfileCredentialsPage=n(843).default,window.TC.ProfileNewslettersPage=n(393).default,window.TC.ProfilePage=n(387).default,window.TC.SearchPage=n(383).default,window.TC.TopicPage=n(839).default,window.TC.User=n(47).default},387:function(e,t,n){"use strict";n.r(t);var i=n(8),r=n(2),o=n(0),a=n.n(o),s=n(1),l=n(3),u=n(11),c=n(7),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var f=void 0,h=((f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Model),p(t,null,[{key:"initClass",value:function(){this.prototype.urlRoot="/author_communications"}}]),t}()).initClass(),f=f),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),m=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0};var y=void 0,b=((y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,u.a),d(t,[{key:"initialize",value:function(e){var n=this;return m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.author_id=e.author_id,this.availableFor=e.availableFor,this.render(),this.emailEl=a()("input[type=text]",this.el),Object(s.defer)(function(){return n.emailEl.focus()})}},{key:"render",value:function(){return a()(this.innerEl).html(this.template({author_id:this.author_id,reasons:this.availableFor})),m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this)}},{key:"_attributesFromForm",value:function(){return Object(s.fromPairs)(Object(s.map)(this.$el.find("form").serializeArray(),function(e){return[e.name,e.value]}))}},{key:"_contactAuthor",value:function(e){var t=this;return e.preventDefault(),this.communique=new h,this.communique.save(this._attributesFromForm(),{wait:!0,success:function(e,n,i){return c.a.now("notice",r.a.t("author_communication.messages.success")),t._leave()},error:function(e,n,i){return n.responseJSON&&n.responseJSON.errors&&t._displayErrors(n.responseJSON.errors),c.a.now("alert",r.a.t("author_communication.messages.error"))}})}},{key:"_displayErrors",value:function(e){return this.$el.find("li.error").removeClass("error"),this.$el.find(".inline-errors").remove(),Object(s.each)(Object(s.keys)(e),function(t){var n=a()("#"+t);return n.parents("li").addClass("error"),n.after("<p class='inline-errors'>"+e[t].join(", ")+"</p>")})}}],[{key:"initClass",value:function(){this.prototype.className="contact-author lightbox clearfix",this.prototype.events={"click footer a[data-action=cancel-attributions]":"_leave","click a.submit":"_contactAuthor"},this.prototype.template=Object(s.template)('<div id="contact-author">\n  <h1 class="page-header"><%- i18n.t(\'author_communication.label.contact_author\') %></h1>\n\n  <form class="formtastic newform">\n    <fieldset class="inputs">\n      <ol>\n        <input id="to_author_id" type="hidden" name="to_author_id" value="<%- author_id %>">\n\n        <li class="from_name string input">\n          <label for="from_name">\n            <%- i18n.t(\'author_communication.label.your_name\') %>\n          </label>\n\n          <input\n            id="from_name"\n            name="from_name"\n            type="text"\n            autocomplete="off"\n            placeholder="<%- i18n.t(\'author_communication.placeholders.your_full_name\') %>"\n            maxlength="255"\n            value="<%- TC.currentUser.get("full_name") %>"\n          >\n        </li>\n\n        <li class="from_email string input">\n          <label for="from_email">\n            <%- i18n.t(\'author_communication.label.your_email\') %>\n          </label>\n\n          <input\n            id="from_email"\n            name="from_email"\n            type="email"\n            autocomplete="off"\n            placeholder="<%- i18n.t(\'author_communication.placeholders.your_email_address\') %>"\n            value="<%- TC.currentUser.get("email") %>"\n          >\n        </li>\n\n        <li class="reason-for-contacting select input">\n          <label for="reason">\n            <%- i18n.t(\'author_communication.label.reason_for_contacting\') %>\n          </label>\n\n          <select name="reason">\n            <% _.each(reasons, function(reason) {%>\n              <option value="<%- reason[\'slug\'] %>"><%- reason[\'label\'] %></option>\n            <% }); %>\n          </select>\n        </li>\n\n        <li class="required text input">\n          <label for="message">\n            <%- i18n.t(\'author_communication.label.your_message\') %>\n          </label>\n\n          <textarea\n            id="message"\n            name="message"\n            rows="12"\n            placeholder="<%- i18n.t(\'author_communication.placeholders.your_message\') %>"\n          ></textarea>\n        </li>\n      </ol>\n    </fieldset>\n  </form>\n</div>\n\n<footer class="button-row">\n  <a data-action="cancel-attributions" class="button secondary" href="#">\n      <%- i18n.t(\'author_communication.button.close\') %>\n    </a>\n\n  <a class="submit button primary" href="#">\n      <%- i18n.t(\'author_communication.button.contact\') %>\n    </a>\n</footer>',{imports:{i18n:r.a}})}}]),t}()).initClass(),y=y),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),_=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0};var g=void 0,w=((g=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.View),v(t,[{key:"initialize",value:function(e){return _(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.render=this.render.bind(this),this._userBannedFromContactingAuthors=this._userBannedFromContactingAuthors.bind(this),this._userNotSignedIn=this._userNotSignedIn.bind(this),this._contactAuthor=this._contactAuthor.bind(this),this.user_id=e.user_id,this.currentUserCanContactAuthors=e.currentUserCanContactAuthors,this.contactable=e.contactable,this.availableFor=e.availableFor,this.render()}},{key:"render",value:function(){switch(!1){case!!this.contactable:break;case!this._userNotSignedIn():this.$el.prepend(this._signUpToContactButtonTemplate());break;case!this._userBannedFromContactingAuthors():break;default:this.$el.prepend(this._contactButtonTemplate())}return _(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this)}},{key:"_userBannedFromContactingAuthors",value:function(){return!this.currentUserCanContactAuthors}},{key:"_userNotSignedIn",value:function(){return a.a.isEmptyObject(TC.currentUser.attributes)}},{key:"_contactAuthor",value:function(e){return e.preventDefault(),new b({author_id:this.user_id,availableFor:this.availableFor}).$el.appendTo(document.body)}}],[{key:"initClass",value:function(){this.prototype.events={"click .profile-contact-button.signed-in":"_contactAuthor"},this.prototype._contactButtonTemplate=Object(s.template)('<a class="profile-contact-button signed-in button primary large" href="#">\n  <%- i18n.t(\'author_communication.button.contact\') %>\n</a>',{imports:{i18n:r.a}}),this.prototype._signUpToContactButtonTemplate=Object(s.template)('<a\n  class="profile-contact-button sign-up-required button primary large"\n  href="/sign_in?return_to='+window.location.pathname+"\"\n>\n  <%- i18n.t('author_communication.button.sign_in_to_contact') %>\n</a>",{imports:{i18n:r.a}})}}]),t}()).initClass(),g=g),O=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.default=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["default"]),O(t,[{key:"initialize",value:function(e){return this._renderContactAuthor=this._renderContactAuthor.bind(this),this.user_id=e.user_id,this.isAuthor=e.is_author,this.currentUserCanContactAuthors=e.currentUserCanContactAuthors,this.contactable=e.contactable,this.availableFor=e.availableFor,this.isAuthor&&this._renderContactAuthor(),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"_renderContactAuthor",value:function(){var e=new w({user_id:this.user_id,currentUserCanContactAuthors:this.currentUserCanContactAuthors,contactable:this.contactable,availableFor:this.availableFor,el:this.$el.find(".profile-user-details")});return this.$el.find(".profile-user-details").prepend(e.el)}}]),t}()},389:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(1),a=n(15),s=n(3),l=n(9),u=n.n(l),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var p=void 0,f=((p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),c(t,[{key:"initialize",value:function(e){return this.searchTerm=e.searchTerm,function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"performSearch",value:function(e){return e.preventDefault(),this.searchTerm=r()("#expert_search_form_term").val(),this._notifySubscribers()}},{key:"_notifySubscribers",value:function(){var e=this;return Object(o.defer)(function(){return u.a.publish("update:term",[e.searchTerm])})}}],[{key:"initClass",value:function(){this.prototype.el=r()(".experts-search-facets .explanation"),this.prototype.events={"submit .expert_search_form":"performSearch"}}}]),t}()).initClass(),p=p),h=n(2),d=n(13),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var y=void 0,b=((y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),m(t,[{key:"initialize",value:function(e){return this._initializeChooser=this._initializeChooser.bind(this),this._institutionList=this._institutionList.bind(this),this.selectedInstitutions=e.selectedInstitutions,this.render(),this._initializeChooser(),this._updateChooserUrl(),this._renderSelectedInstitutions(),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"render",value:function(){return this.$el.html(this.template())}},{key:"_removeSelection",value:function(e){e.preventDefault();var t=r()(e.currentTarget);return this.selectedInstitutions=Object(o.reject)(this.selectedInstitutions,function(e){return e.id===t.data("id")}),this._updateChooserUrl(),this._renderSelectedInstitutions(),this._notifySubscribers()}},{key:"_initializeChooser",value:function(e){var t=this,n=this.$el.find(".institutions .facet");return this.institutionChooser=new d.default({title:"e.g. Monash University",source:this._institutionList()}),n.after(this.institutionChooser.$el),this.institutionChooser.on("selected",function(e){return t.selectedInstitutions.push(e.institution),t._updateChooserUrl(),t._renderSelectedInstitutions(),t._notifySubscribers(),t.institutionChooser.reset()})}},{key:"_institutionList",value:function(){var e="/institutions/search.json",t=Object(o.map)(this.selectedInstitutions,function(e){return e.id});return t.length>0&&(e+="?ignored_institution_id="+t.join(",")),e}},{key:"_updateChooserUrl",value:function(){return this.institutionChooser.setSource(this._institutionList())}},{key:"_renderSelectedInstitutions",value:function(){var e=this,t=this.$el.find(".institutions .selections");return t.empty(),Object(o.each)(this.selectedInstitutions,function(n){return t.append(e.selectionTemplate({label:n.name,slug:n.slug,id:n.id,type:"institution"}))})}},{key:"_notifySubscribers",value:function(){var e=this;return Object(o.defer)(function(){return u.a.publish("update:institutions",[e.selectedInstitutions])})}}],[{key:"initClass",value:function(){this.prototype.events={"click .selection":"_removeSelection"},this.prototype.template=Object(o.template)('<div class="institutions grid-four">\n  <h3 class="double-bordered"><%= i18n.t(\'experts.label.refine_by_institution\') %></h3>\n  <div class="facet"></div>\n  <ul class="selections"></ul>\n</div>',{imports:{i18n:h.a}}),this.prototype.selectionTemplate=Object(o.template)("<li>\n  <a class=\"selection\" href='<%- slug %>' data-type='<%- type %>' data-id='<%- id %>'>\n    <i class=\"icon-delete\"></i> <%- label %>\n  </a>\n</li>")}}]),t}()).initClass(),y=y),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var _=void 0,g=((_=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),v(t,[{key:"initialize",value:function(e){return this._initializeChooser=this._initializeChooser.bind(this),this.allCountries=e.allCountries,this.selectedCountries=e.selectedCountries,this.render(),this._initializeChooser(),this._renderSelectedCountries(),this._updateChooserUrl(),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"render",value:function(){return this.$el.html(this.template())}},{key:"_removeSelection",value:function(e){e.preventDefault();var t=r()(e.currentTarget);return this.selectedCountries=Object(o.reject)(this.selectedCountries,function(e){return e.slug===t.data("id")}),this._renderSelectedCountries(),this._updateChooserUrl(),this._notifySubscribers()}},{key:"_initializeChooser",value:function(e){var t=this,n=this.$el.find(".countries .facet");return this.locationChooser=new d.default({title:"e.g. Australia",autoFocus:!0,source:this._remainingCountries()}),n.after(this.locationChooser.$el),this.locationChooser.on("selected",function(e){return t.selectedCountries.push(e),t._renderSelectedCountries(),t._updateChooserUrl(),t._notifySubscribers(),t.locationChooser.reset()})}},{key:"_updateChooserUrl",value:function(){return this.locationChooser.setSource(this._remainingCountries())}},{key:"_remainingCountries",value:function(){var e=this;return Object(o.reject)(this.allCountries,function(t){return Object(o.some)(e.selectedCountries,function(e){return e.slug===t.slug})})}},{key:"_renderSelectedCountries",value:function(){var e=this,t=this.$el.find(".countries .selections");return t.empty(),Object(o.each)(this.selectedCountries,function(n){return t.append(e.selectionTemplate({label:n.label,slug:n.slug,id:n.slug,type:"countries"}))})}},{key:"_notifySubscribers",value:function(){var e=this;return Object(o.defer)(function(){return u.a.publish("update:countries",[e.selectedCountries])})}}],[{key:"initClass",value:function(){this.prototype.events={"click .selection":"_removeSelection"},this.prototype.template=Object(o.template)('<div class="countries grid-four grid-last">\n  <h3 class="double-bordered"><%= i18n.t(\'experts.label.refine_by_country\') %></h3>\n  <div class="facet"></div>\n  <ul class="selections"></ul>\n</div>',{imports:{i18n:h.a}}),this.prototype.selectionTemplate=Object(o.template)("<li>\n  <a class=\"selection\" href='<%- slug %>' data-type='<%- type %>' data-id='<%- id %>'>\n    <i class=\"icon-delete\"></i> <%- label %>\n  </a>\n</li>")}}]),t}()).initClass(),_=_),w=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var O=void 0,k=((O=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),w(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.render(e)}},{key:"render",value:function(e){return this._renderTerm(e.on),this._renderInstitutions(e.from),this._renderCountries(e.in,e.allCountries)}},{key:"_renderTerm",value:function(e){return this.searchTerm=e,this.termFacetView=new f({searchTerm:e}),this.termFacetView.$el.appendTo(this.el)}},{key:"_renderInstitutions",value:function(e){return this.selectedInstitutions=[],this.institutionsFacetView=new b({selectedInstitutions:e||[]}),this.institutionsFacetView.$el.appendTo(this.el)}},{key:"_renderCountries",value:function(e,t){return this.selectedCountries=[],this.countriesFacetView=new g({selectedCountries:e||[],allCountries:t}),this.countriesFacetView.$el.appendTo(this.el)}}],[{key:"initClass",value:function(){this.prototype.className="expert-search-view"}}]),t}()).initClass(),O=O),C=n(334),j=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var P=void 0;t.default=((P=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,C.default),j(t,[{key:"initialize",value:function(e){var n=this;(function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._activateSubscriber=this._activateSubscriber.bind(this),this._update=this._update.bind(this),this._updateUrl=this._updateUrl.bind(this),this._fetchPaginatedResults=this._fetchPaginatedResults.bind(this),this._prepareUrl=this._prepareUrl.bind(this),this._updateResults=this._updateResults.bind(this),this.pushstate_supported="function"==typeof window.history.pushState,this.spinner=new a.a({size:"30px",fixed:!0}),this.spinner.$el.appendTo(r()(".experts-search-facets")),this.spinner.hide();var i=new k(e);return r()(".experts-search-facets").append(i.$el),this.facets={term:e.on||"",interests:e.for||[],institutions:e.from||[],countries:e.in||[]},this._activateSubscriber("term"),this._activateSubscriber("interests"),this._activateSubscriber("institutions"),this._activateSubscriber("countries"),r()(window).on("popstate",function(e){return n._prepareUrl(window.location.href)})}},{key:"_activateSubscriber",value:function(e){var t=this;return u.a.subscribe("update:"+e,function(n){return t.facets[e]=n,t._update()})}},{key:"_update",value:function(){return this._updateUrl(),this._updateResults(window.location.href+".json")}},{key:"_updateUrl",value:function(){var e="/experts/search";return this.facets.term.length>0&&(e+="/on/"+this._toSlug(this.facets.term,"+")),this.facets.interests.length>0&&(e+=this._addFacetsToUrl("for",this.facets.interests)),this.facets.institutions.length>0&&(e+=this._addFacetsToUrl("from",this.facets.institutions)),this.facets.countries.length>0&&(e+=this._addFacetsToUrl("in",this.facets.countries)),this.pushstate_supported?history.pushState({},e,e):window.location.href(e)}},{key:"_fetchPaginatedResults",value:function(e){e.preventDefault();var t=r()(e.currentTarget).attr("href");return this.pushstate_supported?(this._prepareUrl(t),history.pushState(null,null,t.replace(/\.json/,""))):window.location.href(t)}},{key:"_prepareUrl",value:function(e){return e.match(/\.json/)||(e.match(/\?/)?e=e.replace(/\?/,".json?"):e+=".json"),this._updateResults(e)}},{key:"_updateResults",value:function(e){var t=this;this.spinner.show();var n=r()(".experts-search-results");return n.addClass("searching"),r.a.ajax({type:"GET",url:e,dataType:"html",success:function(e){return n.removeClass("searching"),t.spinner.hide(),n.html(e),r()("html, body").animate({scrollTop:0},"fast")}})}},{key:"_addFacetsToUrl",value:function(e,t){return"/"+e+"/"+Object(o.map)(t,function(e){return e.slug}).join("/")}},{key:"_toSentence",value:function(e){return e.join(", ").replace(/,\s([^,]+)$/," and $1")}},{key:"_deSlug",value:function(e){return e.split("+").join(" ")}},{key:"_toSlug",value:function(e,t){return e.replace(/\s/g,t).toLowerCase()}}],[{key:"initClass",value:function(){this.prototype.events={"click .pagination a":"_fetchPaginatedResults"}}}]),t}()).initClass(),P=P)},393:function(e,t,n){"use strict";n.r(t);var i=n(8),r=n(5),o=n.n(r),a=n(4),s=n.n(a);var l=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentEmail=t.current_email,this.emails=t.emails,this.slug=t.slug},u=n(378),c=n.n(u),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onEmailChange=n.props.onEmailChange.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.a.Component),p(t,[{key:"render",value:function(){var e=this.props.user,t=e.emails.map(function(e){return s.a.createElement("option",{key:e,value:e},e)});return s.a.createElement("div",{className:"email-selector "+c.a.selector},s.a.createElement("label",{htmlFor:"email"},"Email"),s.a.createElement("select",{name:"email",id:"email",defaultValue:e.currentEmail,onChange:this.onEmailChange},t))}}]),t}();f.propTypes={onEmailChange:o.a.func.isRequired,user:o.a.instanceOf(l).isRequired};var h=f,d=n(2);var m=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.code=t.code,this.name=t.name},y=n(184);var b=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.blurb=t.blurb,this.confirmed=t.confirmed,this.frequency=t.frequency,this.listId=t.listId,this.logoUrl=t.logoUrl,this.name=t.name,this.region=new m(t.region),this.subscribed=t.subscribed},v=n(182),_=n(0),g=n(44),w=n.n(g),O=n(87),k=n.n(O),C=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var j=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleSubscription=n.toggleSubscription.bind(n),n.state={subscribed:n.props.newsletterSubscription.subscribed},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.a.Component),C(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({subscribed:e.newsletterSubscription.subscribed})}},{key:"toggleSubscription",value:function(){var e=!this.state.subscribed,t=this.props.newsletterSubscription,n=this.props.user,i="/profiles/:profile_id/newsletters/:list_id".replace(":profile_id",n.slug).replace(":list_id",t.listId);this.setState({subscribed:e}),Object(_.ajax)({url:i,type:"POST",data:{email:n.currentEmail,subscribed:e}})}},{key:"toggleSwitchElement",value:function(){var e=this.props.newsletterSubscription;return e.confirmed?s.a.createElement(v.a,{checked:this.state.subscribed,name:"toggle-switch",onChange:this.toggleSubscription,value:e.listId}):d.a.t("profile_newsletters.subscriptions.pending_confirmation")}},{key:"render",value:function(){var e=this.props.newsletterSubscription,t=e.region;return s.a.createElement("div",{className:"newsletter-subscription-row "+k.a.container+" newsletter-"+e.listId},s.a.createElement("div",{className:k.a.image},s.a.createElement("img",{src:e.logoUrl,alt:e.name})),s.a.createElement("div",{className:k.a.description},s.a.createElement("h2",{className:w()("newsletter-name")},e.name),s.a.createElement("h3",{className:w()("newsletter-region",k.a["description-region"])},d.a.t("profile_newsletters.regions.the_conversation")," ",t.name),s.a.createElement("h4",{className:w()("newsletter-frequency",k.a["description-frequency"])},e.frequency),s.a.createElement("div",{className:w()("newsletter-blurb",k.a["description-blurb"])},e.blurb)),s.a.createElement("div",{className:k.a["toggle-switch"]},s.a.createElement("div",{className:k.a["toggle-switch-element"]},this.toggleSwitchElement())))}}]),t}();j.propTypes={newsletterSubscription:o.a.instanceOf(b).isRequired,user:o.a.instanceOf(l).isRequired};var P=j,T=n(1),S=n(337),E=n.n(S),x=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),D=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var M=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onEmailChange=n.onEmailChange.bind(n),n.timerId=null,n.state={loaded:!1,newsletterSubscriptions:[],user:n.props.user},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.a.Component),D(t,[{key:"componentWillMount",value:function(){this.fetchSubscriptions(this.state.user)}},{key:"componentWillUpdate",value:function(e,t){var n=this;t.loaded||(this.timerId=setTimeout(function(){return n.fetchSubscriptions(t.user)},2e3))}},{key:"onEmailChange",value:function(e){clearTimeout(this.timerId);var t=new l(this.state.user);t.currentEmail=e.target.value,this.fetchSubscriptions(t)}},{key:"fetchSubscriptions",value:function(e){var t=this,n="/profiles/:profile_id/newsletters/subscriptions".replace(":profile_id",e.slug);Object(_.ajax)({url:n,type:"GET",data:{email:e.currentEmail},success:function(n){var i=n.loaded,r=n.subscriptions.map(function(e){return new b(e)});t.setState({loaded:!!i,newsletterSubscriptions:r,user:e})}})}},{key:"loadingSpinner",value:function(){return this.state.loaded?null:s.a.createElement("div",{className:w()("spinner-container",E.a["spinner-container"])},s.a.createElement(y.a,{loaded:!0}))}},{key:"renderSubscriptionRows",value:function(e){var t=this;return e.map(function(e){return s.a.createElement(P,{key:e.listId,newsletterSubscription:e,user:t.state.user})})}},{key:"renderInternationalNewsletterHeading",value:function(e){return 0===e.length?null:s.a.createElement("h2",{className:w()("international-newsletters-heading",E.a["international-newsletters-heading"])},d.a.t("profile_newsletters.heading.international_newsletters"))}},{key:"render",value:function(){var e=this.props.currentRegion,t=Object(T.partition)(this.state.newsletterSubscriptions,function(t){return t.region.code===e.code}),n=x(t,2),i=n[0],r=n[1];return s.a.createElement("div",null,s.a.createElement(h,{user:this.state.user,onEmailChange:this.onEmailChange}),this.loadingSpinner(),s.a.createElement("div",{className:"local-newsletters"},this.renderSubscriptionRows(i)),s.a.createElement("div",{className:"international-newsletters"},this.renderInternationalNewsletterHeading(r),this.renderSubscriptionRows(r)))}}]),t}();M.propTypes={currentRegion:o.a.instanceOf(m).isRequired,user:o.a.instanceOf(l).isRequired};var R=M,$=n(18),F=n.n($);var I=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),i=document.getElementById("profile-newsletters-index"),r=s.a.createElement(R,{user:new l(e.user),currentRegion:new m(e.currentRegion)});return F.a.render(r,i),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["default"]),t}();t.default=I},398:function(e,t,n){"use strict";n.r(t);var i=n(2),r=n(0),o=n.n(r),a=n(1),s=n(84),l=n.n(s),u=n(9),c=n.n(u),p=n(57),f=n(86),h=n(210),d=n(178),m=n(191),y=n(8),b=n(3),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var _=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b["Model"]),v(t,[{key:"url",value:function(){return"/comments?content_id="+this.content_id}},{key:"initialize",value:function(e){return this.content_id=e.content_id}}]),t}(),g=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var w=void 0,O=((w=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.Collection),g(t,[{key:"initialize",value:function(e,t){var n;return n=null!=t,this.content_id=n.content_id,n}}],[{key:"initClass",value:function(){this.prototype.url="/comments/recommends"}}]),t}()).initClass(),w=w),k=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var C=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return o.toggle=o.toggle.bind(o),o.softSubscribe=o.softSubscribe.bind(o),o.subscribe=o.subscribe.bind(o),o.suppress=o.suppress.bind(o),o.isSubscribed=o.isSubscribed.bind(o),o._handleError=o._handleError.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b["Model"]),k(t,[{key:"url",value:function(){return"/content/"+this.content_id+"/content_subscription"}},{key:"initialize",value:function(e){return this.content_id=e.content_id}},{key:"toggle",value:function(){switch(this.get("subscription_type")){case"subscribed":return this.suppress();case"suppressed":case"undetermined":return this.subscribe()}}},{key:"softSubscribe",value:function(){if("undetermined"===this.get("subscription_type"))return this.subscribe()}},{key:"subscribe",value:function(){return this.save({subscription_type:"subscribed"},{type:"PUT",error:this._handleError})}},{key:"suppress",value:function(){return this.save({subscription_type:"suppressed"},{type:"PUT",error:this._handleError})}},{key:"isSubscribed",value:function(){return"subscribed"===this.get("subscription_type")}},{key:"_handleError",value:function(){return this.set("subscription_type",this.previous("subscription_type"))}}]),t}(),j=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return j(e,[{key:"validate",value:function(e){return this.permissions[e]||!1}}]),e}(),T=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var S=void 0,E=((S=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,P),T(t,null,[{key:"initClass",value:function(){this.prototype.permissions={_renderCommentRecommendsView:!0,_renderSignInToCommentButtonView:!1,_renderNewCommentButtonView:!0,_renderContentSubscriptionIndicatorView:!0,_renderReportButton:!0,_renderReplyButton:!0,_renderModeratorControls:!1,_renderEditorControls:!1}}}]),t}()).initClass(),S=S),x=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var D=void 0,M=((D=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,P),x(t,null,[{key:"initClass",value:function(){this.prototype.permissions={_renderCloseCommentsButtonView:!0,_renderOpenCommentsButtonView:!0,_renderCommentRecommendsView:!0,_renderContentSubscriptionIndicatorView:!0,_renderSignInToCommentButtonView:!1,_renderNewCommentButtonView:!0,_renderReportButton:!0,_renderReplyButton:!0,_renderModeratorControls:!1,_renderEditorControls:!0}}}]),t}()).initClass(),D=D),R=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var $=void 0,F=(($=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,P),R(t,null,[{key:"initClass",value:function(){this.prototype.permissions={_renderModeratorControls:!0,_renderCommentRecommendsView:!0,_renderContentSubscriptionIndicatorView:!0,_renderNewCommentButtonView:!0,_renderReportButton:!0,_renderReplyButton:!0}}}]),t}()).initClass(),$=$),I=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var A=void 0,V=((A=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,P),I(t,null,[{key:"initClass",value:function(){this.prototype.permissions={_renderSignInToCommentButtonView:!0,_renderNewCommentButtonView:!1,_renderContentSubscriptionIndicatorView:!1,_renderReportButton:!0,_renderModeratorControls:!1,_renderEditorControls:!1}}}]),t}()).initClass(),A=A),N=n(15),B=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var z=void 0,U=((z=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i)));return o.recommend=o.recommend.bind(o),o.unrecommend=o.unrecommend.bind(o),o.delete=o.delete.bind(o),o.restore=o.restore.bind(o),o.remove=o.remove.bind(o),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.Model),B(t,[{key:"recommend",value:function(){return o.a.ajax({url:this._recommendUrl(),type:"POST"})}},{key:"unrecommend",value:function(){return o.a.ajax({url:this._unrecommendUrl(),type:"DELETE"})}},{key:"delete",value:function(){var e=this;return o.a.ajax({url:this._deleteUrl(),type:"POST",dataType:"json",success:function(t){return e.trigger("comment:deleted",t.message)},error:function(t){return e.trigger("comment:deleted:failure",t.message)}})}},{key:"restore",value:function(){var e=this;return o.a.ajax({url:this._restoreUrl(),type:"POST",dataType:"json",success:function(t){return e.trigger("comment:restored",t.message)},error:function(t){return e.trigger("comment:restored:failure",t.message)}})}},{key:"remove",value:function(e){var t=this;return o.a.ajax({url:this._removeUrl(),type:"POST",dataType:"json",data:e,success:function(e){return t.trigger("comment:removed",e.message)},error:function(e){return t.trigger("comment:removed:failure",e.message)}})}},{key:"_deleteUrl",value:function(){return"editorial"+this.url()+"/remove"}},{key:"_restoreUrl",value:function(){return"editorial"+this.url()+"/restore"}},{key:"_removeUrl",value:function(){return this.url()+"/remove"}},{key:"_recommendUrl",value:function(){return this.url()+"/recommends?thrust=positive"}},{key:"_unrecommendUrl",value:function(){return this.url()+"/unrecommend"}}],[{key:"initClass",value:function(){this.prototype.urlRoot="/comments"}}]),t}()).initClass(),z=z),Y=n(10),L=n(7),H=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var q=void 0,G=((q=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.View),H(t,[{key:"initialize",value:function(e){return this._handleRestore=this._handleRestore.bind(this),this._handleDelete=this._handleDelete.bind(this),this.comment_user_email=e.comment_user_email,this.comment_user_id=e.comment_user_id,this.render()}},{key:"render",value:function(){return this.$el.html(this.template({comment_user_email:this.comment_user_email,editorial_comments_path:this._editorialCommentsPathFor(this.comment_user_id)}))}},{key:"_handleRestore",value:function(e){if(e.preventDefault(),confirm(i.a.t("comment.messages.restore_comment")))return this.trigger("comment:restore")}},{key:"_handleDelete",value:function(e){if(e.preventDefault(),confirm(i.a.t("comment.messages.remove_comment")))return this.trigger("comment:delete")}},{key:"_editorialCommentsPathFor",value:function(e){return"/editorial/comments?user_id="+e}}],[{key:"initClass",value:function(){this.prototype.className="comment-editor-controls-view",this.prototype.events={"click .restore":"_handleRestore","click .delete":"_handleDelete"},this.prototype.template=Object(a.template)('<a class="moderation-control" href="mailto:<%- comment_user_email %>"><%- i18n.t(\'comment.button.email\') %></a>\n<a class="moderation-control" href="<%- editorial_comments_path %>"><%- i18n.t(\'comment.button.all_comments\') %></a>\n<a class="moderation-control restore" href="#"><%- i18n.t(\'comment.button.restore\') %></a>\n<a class="moderation-control delete" href="#"><%- i18n.t(\'comment.button.delete\') %></a>',{imports:{i18n:i.a}})}}]),t}()).initClass(),q=q),W=n(82),K=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var J=void 0,X=((J=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,W.a),K(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.reasons=[i.a.t("comment_moderator.reasons.copyright_infringement"),i.a.t("comment_moderator.reasons.defamatory"),i.a.t("comment_moderator.reasons.discredited_research"),i.a.t("comment_moderator.reasons.discriminatory"),i.a.t("comment_moderator.reasons.fake_name"),i.a.t("comment_moderator.reasons.misinformation"),i.a.t("comment_moderator.reasons.off_topic"),i.a.t("comment_moderator.reasons.offensive"),i.a.t("comment_moderator.reasons.personal_abuse"),i.a.t("comment_moderator.reasons.spam"),i.a.t("comment_moderator.reasons.threatening"),i.a.t("comment_moderator.reasons.trolling")],this.link=e.link,this.comment=e.comment,this.removalReason=this.comment.get("removal_reason"),this.removedAt=this.comment.get("removed_at"),this.render()}},{key:"render",value:function(){var e=this.link.position();return!this.removedAt&&this.removalReason?(this.$el.html(this.alreadyApprovedTemplate()),this.$el.css("left",e.left+70),this.$el.css("top",e.top-51)):(this.$el.html(this.template({reasons:this.reasons})),this.$el.css("left",e.left+70),this.$el.css("top",e.top-88)),this._listenToOutsideClick()}},{key:"_handleSubmit",value:function(e){return e.preventDefault(),this.trigger("reason:selected",o()(e.target).serializeArray()),this.remove()}}],[{key:"initClass",value:function(){this.prototype.className="comment-moderator-reason-view large-tooltip arrow-left",this.prototype.events={"submit form":"_handleSubmit"},this.prototype.template=Object(a.template)('<h4>\n  <%= i18n.t(\'comment_moderator.comment_removal\') %>\n</h4>\n\n<%= i18n.t(\'comment_moderator.blurb_html\') %>\n\n<form action="#">\n  <select name="reason">\n  <% _.each(reasons, function(reason) { %>\n    <option value="<%- reason %>"><%- reason %></option>\n  <% }); %>\n  </select>\n  <button class="button right" type="submit"><%= i18n.t(\'comment_moderator.confirm_removal\') %></button>\n</form>',{imports:{i18n:i.a}}),this.prototype.alreadyApprovedTemplate=Object(a.template)("<h4>\n  <%= i18n.t('comment_moderator.comment_removal') %>\n</h4>\n\n<p><%= i18n.t('comment_moderator.approved') %></p>",{imports:{i18n:i.a}})}}]),t}()).initClass(),J=J),Z=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var Q=void 0,ee=((Q=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.View),Z(t,[{key:"initialize",value:function(e){return this._handleRemove=this._handleRemove.bind(this),this.render(),this.comment=e.comment}},{key:"render",value:function(){return this.$el.html(this.template())}},{key:"_handleRemove",value:function(e){var t=this;return e.preventDefault(),this.commentModeratorReasonView=new X({link:this.$el.find(".remove"),comment:this.comment}),this.commentModeratorReasonView.$el.appendTo(this.$el),this.commentModeratorReasonView.on("reason:selected",function(e){return t.trigger("comment:remove",e)})}}],[{key:"initClass",value:function(){this.prototype.className="comment-editor-controls-view",this.prototype.events={"click .remove":"_handleRemove"},this.prototype.template=Object(a.template)('<a class="moderation-control remove" href="#"><%- i18n.t(\'comment.button.remove\') %></a>',{imports:{i18n:i.a}})}}]),t}()).initClass(),Q=Q),te=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var ne=void 0,ie=((ne=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.View),te(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._handleRecommend=this._handleRecommend.bind(this),this.recommended=null!=e?e.recommended:void 0,this.highlyRecommended=null!=e?e.highlyRecommended:void 0,this.highlyRecommended&&this.$el.addClass("highly-recommended"),this.recommendButtonView=new Y.a({label:this._buttonText(),className:this._buttonClass()}),this.recommendButtonView.on("click",this._handleRecommend),this.render()}},{key:"render",value:function(){return this.highlyRecommended?this.el.innerHTML=this.highlyRecommendedTemplate():this.el.innerHTML="",this.recommendButtonView.$el.appendTo(this.$el)}},{key:"_updateButton",value:function(){return this.recommendButtonView.setTitle(this._buttonText()),this.recommendButtonView.el.className=this._buttonClass()}},{key:"_buttonClass",value:function(){return this.recommended?"button small primary":"button small"}},{key:"_buttonText",value:function(){return this.recommended?i.a.t("comment.button.recommended"):i.a.t("comment.button.recommend")}},{key:"_handleRecommend",value:function(e){return this.recommended=!this.recommended,this._updateButton(),this.recommended?this.trigger("comment:recommend"):this.trigger("comment:unrecommend")}}],[{key:"initClass",value:function(){this.prototype.tagName="div",this.prototype.className="comment-recommends-view",this.prototype.highlyRecommendedTemplate=Object(a.template)('<i class="icon-favourite"></i>\n<div class="hover tooltip bottom">\n  <p><%= i18n.t(\'comment.label.highly_recommended\') %></p>\n</div>',{imports:{i18n:i.a}})}}]),t}()).initClass(),ne=ne),re=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var oe=void 0,ae=((oe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.View),re(t,[{key:"initialize",value:function(e){return this.fullBody=e.fullBody,this.render()}},{key:"render",value:function(){if(this.el.innerHTML=this.template({fullBody:this.fullBody}),this.fullBody.length>1e3)return o()(this.el).addClass("truncated")}},{key:"_showFullComment",value:function(e){return e.preventDefault(),o()(this.el).removeClass("truncated"),o()(this.el).find(".show-comment").remove()}}],[{key:"initClass",value:function(){this.prototype.className="comment-body-view",this.prototype.events={"click .show-comment":"_showFullComment"},this.prototype.template=Object(a.template)('<div class="comment-body-wrapper">\n  <%= fullBody %>\n</div>\n<a class="show-comment" href="#"><%= i18n.t(\'comment.button.read_more\') %></a>',{imports:{i18n:i.a}})}}]),t}()).initClass(),oe=oe),se=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var le=void 0,ue=((le=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.View),se(t,[{key:"initialize",value:function(e){var n=this;return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._recursiveRenderReplies=this._recursiveRenderReplies.bind(this),this._handleReply=this._handleReply.bind(this),this.renderNext=e.renderNext||function(){return{}},this.permissions=e.permissions,this.userRecommendedCommentIds=e.userRecommendedCommentIds,e.comment&&(this.model=new U(e.comment)),this._initCommentRecommendsView(),this.render(),this.commentActionsEl=this.$el.find(".comment-actions"),this.permissions.validate("_renderCommentRecommendsView")&&this._renderCommentRecommendsView(),this.permissions.validate("_renderReplyButton")&&this._renderReplyButton(),this.permissions.validate("_renderReportButton")&&this._renderReportButton(),this.permissions.validate("_renderModeratorControls")&&this._renderModeratorControls(),this.permissions.validate("_renderEditorControls")&&this._renderEditorControls(),e.renderChildren?this._renderReplies(this.model.get("children")):this.renderNext(),this.model.on("comment:deleted",function(e){return L.a.now("notice",e),n.$el.children(".comment").removeClass("pending").addClass("removed")}),this.model.on("comment:deleted:failure",function(e){return L.a.now("alert","Could not remove the comment, try again")}),this.model.on("comment:restored",function(e){return L.a.now("notice",e),n.$el.children(".comment").removeClass("removed pending")}),this.model.on("comment:restored:failure",function(e){return L.a.now("alert","Could not restore the comment, try again")}),this.model.on("comment:removed",function(e){return L.a.now("notice",e),n.$el.children(".comment").addClass("removed pending")}),this.model.on("comment:removed:failure",function(e){return L.a.now("alert",e)})}},{key:"render",value:function(){if(this.model.get("hidden")?this.el.innerHTML=this.removedCommentTemplate(this.model.attributes):(this.el.innerHTML=this.template(this.model.attributes),this._renderCommentBodyView()),this.model.get("removed_at")&&this.$el.children(".comment").addClass("removed"),this.model.get("removal_reason"))return this.$el.children(".comment").addClass("pending")}},{key:"renderFirstChildForTeaser",value:function(){var e=this.model.get("children");return 0!==e.length&&this._renderReplies([e[0]])}},{key:"_renderCommentBodyView",value:function(){return this.commentBodyContainer=this.$el.find(".full-comment"),this.commentBodyView=new ae({fullBody:this.model.get("full_body")}),this.commentBodyView.$el.prependTo(this.commentBodyContainer)}},{key:"_renderCommentRecommendsView",value:function(){if(!this.model.get("hidden"))return this.commentRecommendsView.$el.prependTo(this.$el)}},{key:"_renderReportButton",value:function(){var e=this.model.url()+"/abuses/new";return this.commentActionsEl.append(o()('<a class="moderation-control report" title="'+i.a.t("comment.button.report_comment")+'" href="'+e+'">'+i.a.t("comment.button.report")+"</a>"))}},{key:"_renderReplyButton",value:function(){return this.replyButton=new Y.a({label:i.a.t("comment.button.reply"),className:"button comment-reply"}),this.replyButton.on("click",this._handleReply),this.replyButton.$el.appendTo(this.$el.find(".more"))}},{key:"_renderModeratorControls",value:function(){return this.commentModeratorControlsView=new ee({comment:this.model}),this.commentModeratorControlsView.$el.appendTo(this.commentActionsEl),this.commentModeratorControlsView.on("comment:remove",this.model.remove)}},{key:"_renderEditorControls",value:function(){return this.commentEditorControlsView=new G({comment_user_id:this.model.get("user_id"),comment_user_email:this.model.get("user_email")}),this.commentEditorControlsView.$el.appendTo(this.commentActionsEl),this.commentEditorControlsView.on("comment:delete",this.model.delete),this.commentEditorControlsView.on("comment:restore",this.model.restore)}},{key:"_initCommentRecommendsView",value:function(){return this.commentRecommendsView=new ie({recommended:this._isRecommended(),highlyRecommended:this.model.get("highly_recommended")}),this.commentRecommendsView.on("comment:recommend",this.model.recommend),this.commentRecommendsView.on("comment:unrecommend",this.model.unrecommend)}},{key:"_isRecommended",value:function(){return-1!==Object(a.indexOf)(this.userRecommendedCommentIds,this.model.get("id"))}},{key:"_renderReplies",value:function(e){return this._recursiveRenderReplies(e)}},{key:"_recursiveRenderReplies",value:function(e){var n=this,i=void 0;return e.length?(i=function(){return Object(a.defer)(n._recursiveRenderReplies,e)},new t({comment:e.shift(),userRecommendedCommentIds:this.userRecommendedCommentIds,permissions:this.permissions,renderNext:i}).$el.appendTo(this.$el.children(".comment-replies"))):Object(a.defer)(this.renderNext)}},{key:"_handleReply",value:function(e){return c.a.publish("comment:new",[this.model.get("id")])}},{key:"_donationUrl",value:function(){var e=this.model.get("donation_url");return TC.currentUser.exists()?e+"&user_id="+TC.currentUser.get("id"):e}}],[{key:"initClass",value:function(){this.prototype.tagName="li",this.prototype.className="comment-view",this.prototype.template=Object(a.template)('<article id="comment_<%- id %>" class="comment <%- user_type %>">\n  <header class="meta">\n    <section class="attribution author-avatar large">\n      <img\n        alt=""\n        class="comment avatar rounded lazyload"\n        data-src="<%- user_avatar_url %>"\n        src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="\n      >\n      <h3 class="fn">\n        <% if (user_profile_url) { %>\n          <a href="<%- user_profile_url %>"><%- user_full_name %></a>\n        <% } else { %>\n          <%- user_full_name %>\n        <% } %>\n        <% if (user_friend_of_tc) { %>\n          <a href="<%- this._donationUrl() %>" class="friend-of-the-conversation-badge">\n            <span>\n              <i class="icon-friend-of-tc-outer"></i>\n              <i class="icon-friend-of-tc-heart"></i>\n              <div class="hover tooltip bottom">\n                <%- i18n.t(\'comment.label.friend_of_the_conversation\', { name: user_full_name }) %>\n              </div>\n            </span>\n          </a>\n        <% } %>\n      </h3>\n      <p>\n        <% if (institution_name && institution_path) { %>\n          <% if (user_occupation) { %>\n            <%- user_occupation %>,\n          <% } %>\n\n          <a href="<%- institution_path %>"><%- institution_name %></a>\n        <% } else { %>\n          <%- user_occupation %>\n        <% } %>\n      </p>\n    </section>\n  </header>\n  <% if (parent_id != undefined) { %>\n    <section class="comment-in-reply-to">\n      <%- i18n.t(\'comment.label.in_reply_to\') %>\n      <a class="comment-in-reply-to-link" href="#comment_<%- parent_id %>">\n        <%- parent_user_full_name%>\n      </a>\n    </section>\n  <% } %>\n  <section class="comment-body">\n    <div class="full-comment">\n      <div class="more">\n        <a class="comment-reference-link" href="#comment_<%- id %>">\n          <time datetime="<%- created_at %>"><%- moment(created_at).fromNow() %></time>\n        </a>\n        <div class="comment-actions"></div>\n      </div>\n    </div>\n  </section>\n</article>\n<ol class="comment-replies"></ol>',{imports:{i18n:i.a}}),this.prototype.removedCommentTemplate=Object(a.template)('<article id="comment_<%- id %>">\n  <p><%- i18n.t(\'comment.label.comment_removed_by_moderator\') %></p>\n</article>\n<ol class="comment-replies"></ol>',{imports:{i18n:i.a}})}}]),t}()).initClass(),le=le),ce=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var pe=void 0,fe=((pe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,W.a),ce(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._onTabClick=this._onTabClick.bind(this),this.render()}},{key:"render",value:function(){return this.$el.html(this.template()),this.hide()}},{key:"_onTabClick",value:function(e){if(e.preventDefault(),!o()(e.target).is(".active"))return this.$(".tab").removeClass("active"),o()(e.target).addClass("active"),o()("#comment-format-basic").toggle(),o()("#comment-format-lists").toggle()}}],[{key:"initClass",value:function(){this.prototype.tagName="form",this.prototype.className="comment-formatting-help-view large-tooltip arrow-right",this.prototype.events={"click .tabbed .tab":"_onTabClick"},this.prototype.template=Object(a.template)("<h4><%= i18n.t('comment.label.formatting_help') %></h4>\n<p>\n  <%= i18n.t('comment.label.allowed_formatting_options') %><br>\n  <%= i18n.t('comment.label.markdown', {\n      markdown: \"<a href='http://daringfireball.net/projects/markdown/syntax' target='_blank'>Markdown</a>\",\n      interpolation: { escapeValue: false }\n    })\n  %>.\n</p>\n\n<nav class=\"tabbed tabbed-condensed\">\n  <a href=\"#basic\" class=\"active tab\"><%= i18n.t('comment.label.formatting_basic') %></a>\n  <a href=\"#lists\" class=\"tab\"><%= i18n.t('comment.label.formatting_lists') %></a>\n</nav>\n\n<div id=\"comment-format-basic\">\n  <dl>\n    <dt><strong><%= i18n.t('comment.label.formatting_basic_bold') %></strong></dt>\n    <dd><code>**<%= i18n.t('comment.label.formatting_basic_text') %>**</code></dd>\n    <dt><em><%= i18n.t('comment.label.formatting_basic_italic') %></em></dt>\n    <dd><code>*<%= i18n.t('comment.label.formatting_basic_text') %>*</code></dd>\n    <dt><%= i18n.t('comment.label.formatting_basic_quote') %></dt>\n    <dd><code>&gt; <%= i18n.t('comment.label.formatting_basic_text') %></code></dd>\n    <dt><%= i18n.t('comment.label.formatting_basic_link') %></dt>\n    <dd><code>[<%= i18n.t('comment.label.formatting_basic_text') %>](http://website.com)</code></dd>\n  </dl>\n</div>\n\n<div id=\"comment-format-lists\">\n  <dl>\n    <dt>\n      <ul>\n        <li><%= i18n.t('comment.label.formatting_lists_item') %></li>\n        <li><%= i18n.t('comment.label.formatting_lists_item') %></li>\n      </ul>\n    </dt>\n    <dd>\n      <code>* <%= i18n.t('comment.label.formatting_lists_item') %><br>* <%= i18n.t('comment.label.formatting_lists_item') %></code>\n    </dd>\n    <dt>\n      <ol>\n        <li><%= i18n.t('comment.label.formatting_lists_numbered_item') %></li>\n        <li><%= i18n.t('comment.label.formatting_lists_numbered_item') %></li>\n      </ol>\n    </dt>\n    <dd>\n      <code>1. <%= i18n.t('comment.label.formatting_lists_numbered_item') %><br>2. <%= i18n.t('comment.label.formatting_lists_numbered_item') %></code>\n    </dd>\n  </dl>\n</div>",{imports:{i18n:i.a}})}}]),t}()).initClass(),pe=pe),he=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var de=void 0,me=((de=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.View),he(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),e.comment&&(this.model=new U(e.comment)),this.render()}},{key:"render",value:function(){return this.el.innerHTML=this.template(this.model.attributes)}},{key:"_donationUrl",value:function(){var e=this.model.get("donation_url");return TC.currentUser.exists()?e+"&user_id="+TC.currentUser.get("id"):e}}],[{key:"initClass",value:function(){this.prototype.tagName="li",this.prototype.className="comment-view",this.prototype.template=Object(a.template)('<article class="comment preview">\n  <header class="meta">\n    <div class="preview-message"><%= i18n.t(\'comment.messages.preview_comment\') %></div>\n    <section class="attribution author-avatar">\n      <img class="comment avatar" height="36" width="36" src="<%- user_avatar_url %>" alt="">\n      <h3 class="fn">\n        <% if (user_profile_url) { %>\n          <a href="<%- user_profile_url %>"><%- user_full_name %></a>\n        <% } else { %>\n          <%- user_full_name %>\n        <% } %>\n        <% if (user_friend_of_tc) { %>\n          <a href="<%- this._donationUrl() %>" class="friend-of-the-conversation-badge">\n            <span>\n              <i class="icon-friend-of-tc-outer"></i>\n              <i class="icon-friend-of-tc-heart"></i>\n              <div class="hover tooltip bottom">\n                <%-i18n.t(\'comment.label.friend_of_the_conversation\', { name: user_full_name}) %>\n              </div>\n            </span>\n          </a>\n        <% } %>\n      </h3>\n      <p>\n        <% if (institution_name && institution_path) { %>\n          <% if (user_occupation) { %>\n            <%- user_occupation %>,\n          <% } %>\n\n          <a href="<%- institution_path %>"><%- institution_name %></a>\n        <% } else { %>\n          <%- user_occupation %>\n        <% } %>\n      </p>\n    </section>\n  </header>\n  <section class="comment-body">\n    <div class="full-comment"><%= full_body %></div>\n  </section>\n</article>',{imports:{i18n:i.a}})}}]),t}()).initClass(),de=de),ye=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var be=void 0,ve=((be=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,W.a),ye(t,[{key:"initialize",value:function(e){var n=this;return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._updateCheckbox=this._updateCheckbox.bind(this),this.contentSubscription=e.contentSubscription,this.$el.html(this.template()),this.checkbox=this.$el.find("#notify_when_new_comments"),this.checkbox.on("click",function(){return n.contentSubscription.toggle(),n._trackAnalytics(n.contentSubscription.get("subscription_type"))}),this.contentSubscription.on("change",this._updateCheckbox),this._updateCheckbox(),this.hide()}},{key:"_updateCheckbox",value:function(){return this.checkbox.prop("checked",this.contentSubscription.isSubscribed())}},{key:"_trackAnalytics",value:function(e){return TC.analytics.track("ContentSubscription",e,"UserNotificationSettingsView")}}],[{key:"initClass",value:function(){this.prototype.tagName="form",this.prototype.className="user-notification-settings-view large-tooltip arrow-right",this.prototype.template=Object(a.template)('<h4>\n  <%= i18n.t(\'comment.label.notification_settings\') %>\n</h4>\n<fieldset>\n  <input type="checkbox" id="notify_when_new_comments" name="notify_when_new_comments">\n  <label for="notify_when_new_comments">\n    <%= i18n.t(\'comment.label.notify_me_when_there_are_updates\') %>\n  </label>\n</fieldset>',{imports:{i18n:i.a}})}}]),t}()).initClass(),be=be),_e=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),ge=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0};var we=void 0,Oe=((we=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.View),_e(t,[{key:"initialize",value:function(e){var n=this;return ge(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.remove=this.remove.bind(this),this._handleSubmissionSuccess=this._handleSubmissionSuccess.bind(this),this._handleSubmissionError=this._handleSubmissionError.bind(this),this._handleSubmissionComplete=this._handleSubmissionComplete.bind(this),this._onTabClick=this._onTabClick.bind(this),this._loadPreview=this._loadPreview.bind(this),this._onTextareaFocus=this._onTextareaFocus.bind(this),this._onTextareaBlur=this._onTextareaBlur.bind(this),this.user_full_name=TC.currentUser.get("full_name"),this.render(),this.commentBodyEl=this.$el.find("textarea.comment-body"),this.submitButtonEl=this.$el.find(".button.primary"),this.errorEl=this.$el.find(".comment-errors"),this.contentSubscription=e.contentSubscription,c.a.subscribe("comment:new",this.remove),this.userNoticationSettingsView=new ve({contentSubscription:this.contentSubscription}),this.commentFormattingHelpView=new fe,this.$el.find(".toggle-comment-help").after(this.commentFormattingHelpView.el),this.$el.find(".toggle-comment-options").after(this.userNoticationSettingsView.el),Object(a.defer)(function(){return n.commentBodyEl.focus()})}},{key:"render",value:function(){return o()(this.el).html(this.template({user_full_name:this.user_full_name}))}},{key:"remove",value:function(){return c.a.unsubscribe("comment:new",this.remove),ge(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"remove",this).call(this)}},{key:"_displayErrorMessage",value:function(e){return this.errorEl.html(o()('<p class="information error">').html(e))}},{key:"_disableSubmitButton",value:function(){return this.submitButtonEl.attr("disabled","disabled")}},{key:"_enableSubmitButton",value:function(){return this.submitButtonEl.removeAttr("disabled")}},{key:"_handleClickToggleCommentOptions",value:function(e){return e.preventDefault(),this.commentFormattingHelpView.hide(),this.userNoticationSettingsView.toggle()}},{key:"_handleClickToggleCommentHelp",value:function(e){return e.preventDefault(),this.userNoticationSettingsView.hide(),this.commentFormattingHelpView.toggle()}},{key:"_handleKeyUp",value:function(e){if(o()(e.currentTarget).val().length>10)return this.errorEl.empty(),this._enableSubmitButton()}},{key:"_handleSubmit",value:function(e){return e.preventDefault(),this.submitButtonEl.html(i.a.t("comment.messages.posting")),this._disableSubmitButton(),this.model.save({body:this.commentBodyEl.val()},{wait:!0,success:this._handleSubmissionSuccess,error:this._handleSubmissionError,complete:this._handleSubmissionComplete})}},{key:"_handleSubmissionSuccess",value:function(){return TC.analytics.track("Comment Created",window.location.pathname,""),c.a.publish("comment:created",[this.model]),this.remove()}},{key:"_handleSubmissionError",value:function(e,t){return 422===t.status?(this._displayErrorMessage(t.responseJSON.detailed_error_message),L.a.now("alert",t.responseJSON.message)):(this._displayErrorMessage(i.a.t("comment.messages.error")),this._enableSubmitButton())}},{key:"_handleSubmissionComplete",value:function(){return this.submitButtonEl.html(i.a.t("comment.button.post_comment"))}},{key:"_onTabClick",value:function(e){if(e.preventDefault(),!o()(e.target).is(".active")){var t=e.target.href.split("#").pop(),n=o()(e.target);return"write"===t?(this.$el.find(".tab").removeClass("active"),n.addClass("active"),n.parent().removeClass("preview"),this.$(".comment-form-reply-preview").hide(),this.$(".comment-form-reply-write").show(),this.$(".comment-form-reply-write textarea").focus()):0===this.$("textarea").val().length?(alert("Please type in a comment."),this.$(".comment-form-reply-write textarea").focus()):(this._loadPreview(),this.$el.find(".tab").removeClass("active textarea-focus textarea-blur"),n.addClass("active"),n.parent().addClass("preview"),this.$(".comment-form-reply-write").hide(),this.$(".comment-form-reply-preview").show())}}},{key:"_loadPreview",value:function(){var e=this.$(".comment-form-reply-preview");if(!this.currentBodyText||this.currentBodyText!==this.$("textarea").val())return this.currentBodyText=this.$("textarea").val(),e.html("<p class='loading'>"+i.a.t("comment.messages.preview_loading")+"</p>"),o.a.ajax({url:"/comments/preview",type:"POST",dataType:"json",data:{comment:{content_id:this.model.get("content_id"),body:this.currentBodyText}},success:function(t){return setTimeout(function(){return e.html(""),new me({comment:t}).$el.appendTo(e)},500)},error:function(){return e.html("<p class='loading'>"+i.a.t("comment.messages.preview_error")+"</p>")}})}},{key:"_onTextareaFocus",value:function(){return this.$el.find('.tab[href="#write"]').removeClass("textarea-blur").addClass("textarea-focus")}},{key:"_onTextareaBlur",value:function(){return this.$el.find('.tab[href="#write"]').removeClass("textarea-focus").addClass("textarea-blur")}}],[{key:"initClass",value:function(){this.prototype.tagName="li",this.prototype.events={"focus textarea":"_onTextareaFocus","blur textarea":"_onTextareaBlur","keyup textarea":"_handleKeyUp","input textarea":"_handleKeyUp","paste textarea":"_handleKeyUp","click .submit":"_handleSubmit","click .toggle-comment-help":"_handleClickToggleCommentHelp","click .toggle-comment-options":"_handleClickToggleCommentOptions","click #comment-form-reply > .tabbed .tab":"_onTabClick"},this.prototype.template=Object(a.template)('<div id="comment-form-reply">\n  <div class="comment-errors"></div>\n\n  <nav class="tabbed">\n    <a href="#write" class="active tab"><%= i18n.t(\'comment.button.write\') %></a>\n    <a href="#preview" class="tab"><%= i18n.t(\'comment.button.preview\') %></a>\n  </nav>\n\n  <div class="comment-form-reply-options">\n    <a href="#" class="toggle-comment-options" title="<%= i18n.t(\'comment.label.notification_settings\') %>">\n      <i class="icon-cog"></i>\n    </a>\n\n    <a href="#" class="toggle-comment-help" title="<%= i18n.t(\'comment.label.formatting_help\') %>">\n      <i class="icon-help"></i>\n    </a>\n  </div>\n\n  <div class="comment-form-reply-write">\n    <form id="new_comment" class="new_comment">\n      <label for="comment-form-reply-body"><%= i18n.t(\'comment.label.body\') %></label>\n      <textarea id="comment-form-reply-body" class="comment-body"></textarea>\n\n      <span class="community-standards-link">\n        <a href="/community_standards" target="_blank">\n          <%= i18n.t(\'comment.label.review_community_standards\') %>\n        </a>\n      </span>\n\n      <a href="#" class="submit button primary"><%= i18n.t(\'comment.button.post_comment\') %></a>\n    </form>\n  </div>\n\n  <div class="comment-form-reply-preview"></div>\n</div>',{imports:{i18n:i.a}})}}]),t}()).initClass(),we=we),ke=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var Ce=void 0,je=((Ce=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.View),ke(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.addComment=this.addComment.bind(this),this.createNewComment=this.createNewComment.bind(this),this.renderNoComments=this.renderNoComments.bind(this),this.renderAllComments=this.renderAllComments.bind(this),this.renderComments=this.renderComments.bind(this),this.renderTeaser=this.renderTeaser.bind(this),this.recursiveRender=this.recursiveRender.bind(this),this._renderCommentsFragment=this._renderCommentsFragment.bind(this),this._commentsFragmentReady=this._commentsFragmentReady.bind(this),this.contentSubscription=e.contentSubscription,this.permissions=e.permissions,this.order="#oldest",this.spinner=new N.a({tagName:"li",centered:!0}),this.el.appendChild(this.spinner.el)}},{key:"addComment",value:function(e){this.model.set("comment_count",this.model.get("comment_count")+1),c.a.publish("comments:count:updated",[this.model.get("comment_count")]);var t=e.get("parent_id"),n=new ue({model:e,permissions:this.permissions}),i=this._getContainerFor(t);return n.$el.prependTo(i)}},{key:"createNewComment",value:function(e,t){var n=this._getContainerFor(t),i=new U({content_id:e,parent_id:t}),r=new Oe({model:i,contentSubscription:this.contentSubscription});return this._addReplyForm(r,n)}},{key:"renderNoComments",value:function(){var e=this;return this.$el.html(this.noCommentsTemplate()),c.a.subscribe("comment:new",function(){return e.$el.find(".information.no-comments").remove()})}},{key:"renderAllComments",value:function(e){var t=this;return this.commentsFragmentReady?(this._renderCommentsFragment(this.commentsFragment),"function"==typeof e?e():void 0):c.a.subscribe("comments:fragment:loaded",function(n){return t._renderCommentsFragment(n),"function"==typeof e?e():void 0})}},{key:"renderComments",value:function(e,t,n){this.userRecommendedCommentIds=t,e.get("comments");var i=e.get("comment_count");return c.a.publish("comments:count:updated",[i]),this.commentsFragment=document.createDocumentFragment(),this.commentsFragmentReady=!1,n?c.a.subscribe("comments:fragment:loaded",this._renderCommentsFragment):(c.a.subscribe("comments:teaser:fragment:loaded",this._renderCommentsFragment),c.a.subscribe("comments:fragment:loaded",this._commentsFragmentReady),this.renderTeaser(e.get("comments"))),this.recursiveRender(e.get("comments"))}},{key:"renderTeaser",value:function(e){e=Object(a.first)(e,2);var t=document.createDocumentFragment();if(e.length>=1){var n=new ue({comment:e[0],userRecommendedCommentIds:this.userRecommendedCommentIds,permissions:this.permissions,renderChildren:!1});n.$el.appendTo(t),!n.renderFirstChildForTeaser()&&e.length>=2&&(n=new ue({comment:e[1],userRecommendedCommentIds:this.userRecommendedCommentIds,permissions:this.permissions,renderChildren:!1})).$el.appendTo(t)}return c.a.publish("comments:teaser:fragment:loaded",[t])}},{key:"recursiveRender",value:function(e){var t=this;if(e.length){var n=e.shift();return new ue({comment:n,userRecommendedCommentIds:this.userRecommendedCommentIds,permissions:this.permissions,renderChildren:!0,renderNext:function(){return Object(a.defer)(t.recursiveRender,e)}}).$el.appendTo(this.commentsFragment)}return c.a.publish("comments:fragment:loaded",[this.commentsFragment])}},{key:"sortComments",value:function(e){if(this.order!==e)return this._changeSortOrder(),this.order=e}},{key:"_changeSortOrder",value:function(){var e=this;return this.$el.animate({opacity:.25},100,function(){return e.$el.children("li").each(function(){return o()(this).prependTo(o()(this).parent())}),e.$el.css({opacity:1})})}},{key:"_renderCommentsFragment",value:function(e){var t=this;return this.spinner.hide(function(){var n=o()(window).scrollTop();return t.$el.find(".comment-view").remove(),t.$el.prepend(e),o()(window).scrollTop(n),c.a.publish("comments:fragment:ready")})}},{key:"_commentsFragmentReady",value:function(){return this.commentsFragmentReady=!0}},{key:"_addReplyForm",value:function(e,t){var n=t||this.$el;return e.$el.prependTo(n)}},{key:"_getContainerFor",value:function(e){return o()("#comment_"+e).siblings(".comment-replies").get(0)||this.$el}}],[{key:"initClass",value:function(){this.prototype.className="comments-list-view",this.prototype.tagName="ol",this.prototype.noCommentsTemplate=Object(a.template)("<li class=\"information prominent no-comments\">\n  <strong><%= i18n.t('comment.label.no_comments_yet') %></strong>\n  <br />\n  <%= i18n.t('comment.label.have_your_say') %>\n</li>",{imports:{i18n:i.a}})}}]),t}()).initClass(),Ce=Ce),Pe=n(64),Te=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var Se=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Pe["a"]),Te(t,[{key:"initialize",value:function(e){var n=this;return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._updateView=this._updateView.bind(this),this._flashSuccess=this._flashSuccess.bind(this),this._flashError=this._flashError.bind(this),this._setSubscriptionType=this._setSubscriptionType.bind(this),this._getColorForType=this._getColorForType.bind(this),this._getLabelForType=this._getLabelForType.bind(this),this._getNoticeForType=this._getNoticeForType.bind(this),this.contentId=e.contentId,this.contentSubscription=e.contentSubscription,this._setSubscriptionType("undetermined"),this.contentSubscription.on("change",this._updateView),this.contentSubscription.on("sync",this._flashSuccess),this.contentSubscription.on("error",this._flashError),this.contentSubscription.fetch(),c.a.subscribe("comment:created",function(){return n.contentSubscription.fetch(),n._updateView()}),this.on("click",function(){return n.contentSubscription.toggle(),n._track(n.contentSubscription.get("subscription_type"))})}},{key:"_updateView",value:function(){return this._setSubscriptionType(this.contentSubscription.get("subscription_type"))}},{key:"_flashSuccess",value:function(){if(null!=this.contentSubscription.previous("subscription_type")){var e=this.contentSubscription.get("subscription_type");if(null!=this._getNoticeForType(e))return L.a.now("notice",this._getNoticeForType(e))}}},{key:"_flashError",value:function(){return L.a.now("notice",this._getNoticeForType("error"))}},{key:"_setSubscriptionType",value:function(e){return this.setTitle(this._getLabelForType(e)),this.setColor(this._getColorForType(e))}},{key:"_getColorForType",value:function(e){switch(e){case"subscribed":return Pe.a.GREEN;case"suppressed":case"undetermined":return Pe.a.RED;default:return}}},{key:"_getLabelForType",value:function(e){switch(e){case"subscribed":return i.a.t("content.subscription_type.subscribed.label");case"suppressed":return i.a.t("content.subscription_type.suppressed.label");case"undetermined":return i.a.t("content.subscription_type.undetermined.label");default:return}}},{key:"_getNoticeForType",value:function(e){switch(e){case"subscribed":return i.a.t("content.subscription_type.subscribed.notice");case"suppressed":return i.a.t("content.subscription_type.suppressed.notice");case"error":return i.a.t("content.subscription_type.error.notice");default:return}}},{key:"_track",value:function(e){return TC.analytics.track("ContentSubscription",e,"ContentSubscriptionIndicatorView")}}]),t}(),Ee=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var xe=void 0,De=((xe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.View),Ee(t,[{key:"initialize",value:function(e){if(function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.permissions=e.permissions,this.contentId=e.contentId,this.contentSubscription=e.contentSubscription,this.permissions.validate("_renderSignInToCommentButtonView")&&this._renderSignInToCommentButtonView(),this.permissions.validate("_renderNewCommentButtonView")&&this._renderNewCommentButtonView(),this.permissions.validate("_renderCloseCommentsButtonView")&&this._renderCloseCommentsButtonView(),this.permissions.validate("_renderOpenCommentsButtonView")&&this._renderOpenCommentsButtonView(),this.permissions.validate("_renderContentSubscriptionIndicatorView"))return this._renderContentSubscriptionIndicatorView()}},{key:"_renderSignInToCommentButtonView",value:function(){return this.signInToCommentButtonView=new Y.a({label:i.a.t("comment.button.sign_in_to_comment"),className:"comment-sign-in button primary large"}),this.signInToCommentButtonView.$el.appendTo(this.$el),this.signInToCommentButtonView.on("click",function(){var e;return(e=null!=TC.page?TC.page.content_slug:void 0)?window.location="sign_in?return_to=/"+e+"#comments":window.location="sign_in"})}},{key:"_renderNewCommentButtonView",value:function(){return this.newCommentButtonView=new Y.a({label:i.a.t("comment.button.comment_on_this_article"),className:"button large primary new"}),this.newCommentButtonView.$el.appendTo(this.$el),this.newCommentButtonView.on("click",function(){return c.a.publish("comment:new")})}},{key:"_renderCloseCommentsButtonView",value:function(){return this.closeCommentsButtonView=new Y.a({label:i.a.t("comment.button.close_comments"),className:"button large danger close"}),this.closeCommentsButtonView.$el.appendTo(this.$el),this.closeCommentsButtonView.on("click",function(){if(confirm(i.a.t("comment.messages.close_comments")))return c.a.publish("comments:close")})}},{key:"_renderOpenCommentsButtonView",value:function(){return this.openCommentsButtonView=new Y.a({label:i.a.t("comment.button.re_open_comments"),className:"button large primary open"}),this.openCommentsButtonView.$el.appendTo(this.$el),this.openCommentsButtonView.on("click",function(){if(confirm(i.a.t("comment.messages.re_open_comments")))return c.a.publish("comments:open")})}},{key:"_renderContentSubscriptionIndicatorView",value:function(){return this.contentSubscriptionIndicatorView=new Se({contentId:this.contentId,contentSubscription:this.contentSubscription,className:"button large indicator"}),this.contentSubscriptionIndicatorView.$el.appendTo(this.$el)}}],[{key:"initClass",value:function(){this.prototype.className="comments-actions-view grid-four grid-last",this.prototype.tagName="div"}}]),t}()).initClass(),xe=xe),Me=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var Re=void 0,$e=((Re=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,b.View),Me(t,[{key:"initialize",value:function(e){var n=this;(function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._transitionToReady=this._transitionToReady.bind(this),this._newComment=this._newComment.bind(this),this._commentsOpened=this._commentsOpened.bind(this),this._commentsClosed=this._commentsClosed.bind(this),this._renderSortButtons=this._renderSortButtons.bind(this),this._renderShowMoreButton=this._renderShowMoreButton.bind(this);var i=o()(location).attr("hash");return/comment_[0-9]+/.test(i)&&(this.referenceToComment=i),this.referenceToComment&&Object(a.defer)(function(){return o()("html, body").animate({scrollTop:o()("#comments").offset().top},500)}),this.permissions=function(){switch(!1){case!(null!=TC.currentUser?TC.currentUser.isEditor():void 0):return new M;case!(null!=TC.currentUser?TC.currentUser.isModerator():void 0):return new F;case!(null!=TC.currentUser?TC.currentUser.exists():void 0):return new E;default:return new V}}(),this.contentId=e.content_id,this.comments=new _({content_id:this.contentId}),this.contentSubscription=new C({content_id:this.contentId}),this.commentsActionsView=new De({contentId:this.contentId,permissions:this.permissions,contentSubscription:this.contentSubscription}),this.commentsListView=new je({model:this.comments,permissions:this.permissions,contentSubscription:this.contentSubscription}),c.a.subscribe("comment:new",this._newComment),c.a.subscribe("comment:created",this.commentsListView.addComment),c.a.subscribe("comments:fragment:ready",this._transitionToReady),c.a.subscribe("comments:closed",this._commentsClosed),c.a.subscribe("comments:opened",this._commentsOpened),(null!=TC.currentUser?TC.currentUser.exists():void 0)?(this.commentsRecommends=new O({content_id:this.contentId}),this.commentsRecommends.on("sync",function(){return n.comments.fetch()}),this.commentsRecommends.fetch()):this.comments.fetch(),this.displayAllComments=!1,this.comments.on("sync",function(){return n.commentsListView.renderComments(n.comments,n._userRecommendedCommentIds(),n._displayAllComments())}),this.render(),this.$el.addClass("loading")}},{key:"render",value:function(){return this.el.innerHTML=this.template(),this.commentsListView.$el.appendTo(this.$el.find(".comments-main"))}},{key:"clickNewComment",value:function(e){return e.preventDefault(),this.addComment(o()("#comment-list > ol"))}},{key:"sortComments",value:function(e){e.preventDefault();var t=o()(e.currentTarget),n=t.attr("href");return this.$el.find(".comment-sort").removeClass("on"),t.addClass("on"),this.commentsListView.sortComments(n)}},{key:"_transitionToReady",value:function(){var e=this;if(this.$el.removeClass("loading"),this.comments.get("comment_count")?(this._renderSortButtons(),this._displayAllComments()||this._renderShowMoreButton()):this.commentsListView.renderNoComments(),this.commentsActionsView.$el.appendTo(this.$el.find(".comments-side")),this.referenceToComment&&o()(this.referenceToComment).length>0)return Object(a.defer)(function(){return o()("html, body").animate({scrollTop:o()(e.referenceToComment).addClass("highlight").offset().top},0)})}},{key:"_newComment",value:function(e){return this.commentsListView.createNewComment(this.contentId,e)}},{key:"_userRecommendedCommentIds",value:function(){if(this.commentsRecommends)return Object(a.map)(this.commentsRecommends.models,function(e){return e.get("comment_id")})}},{key:"_commentsOpened",value:function(){return this.$el.removeClass("closed")}},{key:"_commentsClosed",value:function(){return this.$el.addClass("closed")}},{key:"_displayAllComments",value:function(){return this.displayAllComments||this.comments.get("has_current_user_comment")||this.referenceToComment||this.comments.get("comment_count")<3}},{key:"_renderSortButtons",value:function(){return this.$el.find(".comment-sorting").html(this.sortButtonsTemplate())}},{key:"_renderShowMoreButton",value:function(){var e=this,t=o()(this.showAllCommentsButtonTemplate());return this.$el.find(".comments-main").append(t),t.on("click",function(n){return n.preventDefault(),t.addClass("disabled"),e.displayAllComments=!0,e.commentsListView.renderAllComments(function(){return t.remove()})})}}],[{key:"initClass",value:function(){this.prototype.id="comments",this.prototype.className="comments-section-view wrapper clearfix",this.prototype.tagName="section",this.prototype.events={"click a.comment-sort":"sortComments","click .comment-moderator-remove":"showModeratorPane","click .moderation-pane-close":"hideModerationPane","submit .moderation-remove":"handleModerationRemoveSubmit"},this.prototype.sortButtonsTemplate=Object(a.template)('<div class="tabbed-button-group minimal">\n  <a class=" button comment-sort on" href="#oldest">\n    <%= i18n.t(\'comment.button.oldest\') %>\n  </a>\n\n  <a class=" button comment-sort" href="#newest">\n    <%= i18n.t(\'comment.button.newest\') %>\n  </a>\n</div>',{imports:{i18n:i.a}}),this.prototype.showAllCommentsButtonTemplate=Object(a.template)('<div class="comments-show-all">\n  <a href="#" class="primary button large">\n    <%= i18n.t(\'comment.button.show_all_comments\') %>\n  </a>\n</div>',{imports:{i18n:i.a}}),this.prototype.template=Object(a.template)('<div class="comments-bar grid-sixteen">\n  <div class="comments-side grid-four grid-last"></div>\n  <div class="comments-count-sort grid-four">\n    <i class="icon-comment"></i>\n    <span class="comment-count"><span></span></span>\n  </div>\n  <div class="comments-main grid-eight">\n    <div class="comment-sorting"></div>\n    <p class="information prominent closed"><%= i18n.t(\'comment.label.comments_closed\') %></p>\n  </div>\n\n</div>',{imports:{i18n:i.a}})}}]),t}()).initClass(),Re=Re),Fe=n(11),Ie=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Ae=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0};var Ve=Object(a.template)('  <%= republishContent %>\n\n  <footer class="button-row">\n    <a class="button secondary close" href="#">Close</a>\n  </footer>'),Ne=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Fe["a"]),Ie(t,[{key:"initialize",value:function(e){return Ae(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this),this.republishContent=e.republishContent,this.copyAdvice=e.copyAdvice,this.render(),this.$el.find("section.advanced").hide(),this.hideAllCodeBlocks(),this.$el.find("code.image").show()}},{key:"render",value:function(){return Ae(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this),this.$innerEl.html(Ve({republishContent:this.republishContent})),this.$el.find(".copy-advice").html(this.copyAdvice)}},{key:"showBasic",value:function(e){return this.$el.find(".tab.active").removeClass("active"),o()(e.currentTarget).addClass("active"),this.$el.find("section.basic").show(),this.$el.find("section.advanced").hide()}},{key:"showAdvanced",value:function(e){return this.$el.find(".tab.active").removeClass("active"),o()(e.currentTarget).addClass("active"),this.$el.find("section.basic").hide(),this.$el.find("section.advanced").show()}},{key:"showImageCode",value:function(){return this.hideAllCodeBlocks(),this.$el.find("code.image").show()}},{key:"showIframeCode",value:function(){return this.hideAllCodeBlocks(),this.$el.find("code.iframe").show()}},{key:"showScriptCode",value:function(){return this.hideAllCodeBlocks(),this.$el.find("code.script").show()}},{key:"hideAllCodeBlocks",value:function(){this.$el.find("code").hide()}}]),t}(),Be=Ne;Ne.prototype.events={"click .button.close":"_leave","click .tab.basic":"showBasic","click .tab.advanced":"showAdvanced","click input.image":"showImageCode","click input.iframe":"showIframeCode","click input.script":"showScriptCode"};var ze=n(189),Ue=n(209),Ye=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var Le=void 0;t.default=((Le=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,y.default),Ye(t,[{key:"initialize",value:function(e){(function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.closeComments=this.closeComments.bind(this),this.openComments=this.openComments.bind(this),this._toggleArticleSidebar=this._toggleArticleSidebar.bind(this),this._toggleTranslationSidebar=this._toggleTranslationSidebar.bind(this),-1===navigator.platform.indexOf("iPhone")&&new m.a(o()("figure.zoomable > a")),new p.a,this.trackScrolling(),this.initResponsiveFrames(),d.a.init(this.$el),this._initTopbarMobileNewsletterSignup(),c.a.subscribe("comments:count:updated",this.updateCommentCount),c.a.subscribe("comments:close",this.closeComments),c.a.subscribe("comments:open",this.openComments),this.commentsClosedAt=e.comments_closed_at,this.content_slug=e.content_slug,this.content_id=e.content_id,this.commentsSectionView=new $e({content_id:this.content_id}),this.commentsSectionView.$el.appendTo(o()("#comments-container")),this.commentsClosedAt&&c.a.publish("comments:closed",[this.commentsClosedAt]),this.initShareButtons(),this.initPrintButton(),this.initContentBody(),this.initDonationBar()}},{key:"_isUS",value:function(){return o()("body").is(".region_us")}},{key:"_isAU",value:function(){return o()("body").is(".region_au")}},{key:"_isUK",value:function(){return o()("body").is(".region_uk")}},{key:"_isFR",value:function(){return o()("body").is(".region_fr")}},{key:"_isAfrica",value:function(){return o()("body").is(".region_africa")}},{key:"initDonationBar",value:function(){if(this._isAU()){var e=(new Ue.a).el;this.topbar.after(e)}}},{key:"shareClickTracking",value:function(e){var t=o()(e.currentTarget).closest("li").attr("class");return TC.analytics.track("Article page - share clicks",document.location.pathname,t,1)}},{key:"initShareButtons",value:function(){var e=this;return o.a.ajax({url:"/share_counts/"+this.content_id,success:function(t){return e.$(".twitter-button").each(function(e,n){return new f.a({el:n,count:t.tweet_count})}),e.$(".facebook-button").each(function(e,n){return new f.a({el:n,count:t.facebook_count})}),e.$(".linkedin-button").each(function(e,n){return new f.a({el:n,count:t.linked_in_count})})}})}},{key:"initPrintButton",value:function(){var e="<li class='print'><a href='#'><i class='icon-print'></i> "+i.a.t("content.button.print")+"</a></li>";return this.$el.find(".content-share ul").append(e),this.$el.find(".interact-with-this-article ul").append(e)}},{key:"initContentBody",value:function(){var e=document.querySelector("div.content-body");e&&Object(ze.a)(e)}},{key:"printArticle",value:function(e){return e.preventDefault(),TC.analytics.track("Article page - print button clicks",document.location.pathname,"",1),window.print()}},{key:"trackScrolling",value:function(){var e=new Date;if(o()("#article").length>0){for(var t={},n=o()("#article").height(),i=o()("#article").offset().top,r=10;r<=100;r+=10)t[r]=n/100*r+i;var s=function(){var n=o()(window).scrollTop()+o()(window).height();return function(){var i=[];for(var r in t){var o=t[r];if(n>o){if(TC.analytics.track("Article Page - percent scrolled",document.location.pathname,r+"%",1),""+r=="100"){var a=(new Date-e)/1e3;TC.analytics.track("Article Page - article scrolled to bottom",document.location.pathname,"timeTaken",a)}i.push(delete t[r])}else i.push(void 0)}return i}()},l=Object(a.debounce)(s,50);return o()(window).scroll(l),s()}}},{key:"initResponsiveFrames",value:function(){var e=this.$el.find("iframe[responsive='true']");return Object(a.each)(e,function(e,t){return o()(e).hide(),o()(e).before("<div id='responsive-iframe-"+t+"'></div>"),new l.a.Parent("responsive-iframe-"+t,o()(e).attr("src"),{})})}},{key:"republish",value:function(e){var t=this;e.preventDefault();var n=o()(e.currentTarget);return o.a.ajax({url:o()(n).data("republish"),dataType:"text",success:function(e){return new Be({republishContent:e,copyAdvice:t.copy_advice()}).$el.appendTo(document.body)}})}},{key:"copy_advice",value:function(){var e=!navigator.platform.indexOf("iPhone"),t=navigator.platform.indexOf("Mac")?"Ctrl":"⌘";return e?i.a.t("content.message.copying_text_on_mobile_device"):i.a.t("content.message.key_combination_to_press_to_copy_text",{control_or_command_key:t})}},{key:"selectStolenBody",value:function(e){return o()(e.currentTarget).select()}},{key:"closeComments",value:function(){var e="/editorial/content/"+this.content_slug+"/close_comments";return o.a.ajax({url:e,type:"PUT",success:function(e){return c.a.publish("comments:closed",[e.comments_closed_at])}})}},{key:"openComments",value:function(){var e="/editorial/content/"+this.content_slug+"/open_comments";return o.a.ajax({url:e,type:"PUT",success:function(e){return c.a.publish("comments:opened",[e.comments_closed_at])}})}},{key:"updateCommentCount",value:function(e){var t=void 0;return t=1!==e?i.a.t("comment.label.comment_plural"):i.a.t("comment.label.comment_singular"),o()(".comment-count span").html("<span class='number-of-comments'>"+e+"</span> "+t)}},{key:"_toggleArticleSidebar",value:function(e){return e.preventDefault(),this.$el.find(".content-sidebar").toggleClass("open")}},{key:"_toggleTranslationSidebar",value:function(e){return e.preventDefault(),this.$el.find(".content-translations").toggleClass("open")}},{key:"_initTopbarMobileNewsletterSignup",value:function(){if(!this._isAU()){var e=new h.a;this.topbar.after(e.el)}}}],[{key:"initClass",value:function(){this.prototype.events={"click .steal-button":"republish","click form.edit-user input[type=checkbox]":"checkNotificationSettings","click li.print a":"printArticle","click aside.content-share li a":"shareClickTracking","click aside.content-targeted-share li a":"shareClickTracking","click textarea.stolen-body":"selectStolenBody","click .content-translations .content-translations-toggle":"_toggleTranslationSidebar","click .content-authors .content-authors-toggle":"_toggleArticleSidebar"}}}]),t}()).initClass(),Le=Le)},46:function(e,t,n){"use strict";var i=n(2),r=n(0),o=n.n(r),a=n(1),s=n(3),l=n(62),u=n.n(l),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),p=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0};var f=void 0,h=((f=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),c(t,[{key:"initialize",value:function(e){return p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.render(),this._initTrack(),this._initSlider()}},{key:"render",value:function(){return p(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this),this.el.innerHTML=this.template()}},{key:"setValue",value:function(e){var t=e*this.trackEl.width()/100;return this.draggable.setValue(t)}},{key:"_initTrack",value:function(){return this.trackEl=this.$el.find(".super-slider-view-track"),this.cachedTrackWidth=this.trackEl.width()}},{key:"_initSlider",value:function(){var e=this;return this.sliderEl=this.$el.find(".super-slider-view-slider"),this.draggable=new u.a({element:this.sliderEl.get(0),axis:"x",containment:"parent"}),this.sliderEl.get(0).addEventListener("drag",function(t){var n=t.detail.position.x,i=e.trackEl.width();return e.percentage=n/i*100,e._throttledChange()}),this.sliderEl.on("dragstart",function(){return e.trigger("changestart")}),this.sliderEl.on("dragfinish",function(){return e.trigger("changefinish")})}}],[{key:"initClass",value:function(){this.prototype.className="super-slider-view",this.prototype.template=Object(a.template)('<div class="super-slider-view-track">\n  <div class="super-slider-view-slider">\n    <div class="super-slider-view-slider-inner"></div>\n  </div>\n</div>'),this.prototype._throttledChange=Object(a.throttle)(function(){return this.trigger("change",this.percentage)},66)}}]),t}()).initClass(),f=f),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),m=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0};var y=void 0;t.a=((y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),d(t,[{key:"initialize",value:function(e){if(this._play=this._play.bind(this),this._onClickPlay=this._onClickPlay.bind(this),this._onTimeUpdate=this._onTimeUpdate.bind(this),this._onEnded=this._onEnded.bind(this),this.audioEl=o()(e.audioEl),!this.audioEl.hasClass("initialized"))return m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.render()}},{key:"render",value:function(){return m(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"render",this).call(this),this.$el.append(this.template()),this.innerEl=this.$(".audio-player-inner"),this.middleEl=this.$(".audio-player-middle"),this._canPlayAudio()?this._setupSupported():this._setupUnsupported(),this.audioEl.addClass("initialized"),this.audioEl.before(this.$el)}},{key:"_play",value:function(){var e=this;return this.audio.play(),this.timeUpdateInterval=setInterval(function(){return o()(e.audio).trigger("timeupdate")},50)}},{key:"_pause",value:function(){if(this.audio.pause(),this.timeUpdateInterval)return clearInterval(this.timeUpdateInterval)}},{key:"_canPlayAudio",value:function(){return!!document.createElement("audio").canPlayType}},{key:"_setupSupported",value:function(){return this.audio=this.audioEl.get(0),o()(this.audio).on("timeupdate",this._onTimeUpdate),o()(this.audio).on("ended",this._onEnded),this._readData(),this._removeCaption(),this._addImage(),this._addControls(),this._addDownloadLink(),this._addTitle()}},{key:"_setupUnsupported",value:function(){this.audio=this.audioEl.get(0),o()(this.audio).on("timeupdate",this._onTimeUpdate),o()(this.audio).on("ended",this._onEnded),this._readData(),this._removeCaption(),this._addImage(),this._addLicenseWithoutControls(),this._addDownloadLink(),this._addTitle(),this.$el.addClass("no-audio");var e='<span class="unsupported">'+i.a.t("audio_player.message.unsupported")+"</span>";return this.middleEl.find(".audio-player-listen").append(e),this.audioEl.next(".audio-player-caption").show()}},{key:"_readData",value:function(){return this.duration=this.audioEl.data("duration"),this.image=this.audioEl.data("image"),this.title=this.audioEl.data("title"),this.size=this.audioEl.data("size"),this.source=this.audioEl.data("source"),this.sourceUrl=this.audioEl.data("source-url"),this.license=this.audioEl.data("license"),this.licenseUrl=this.audioEl.data("license-url"),this.link=this.audioEl.find("source").attr("src"),this.durationFormatted=this._formatSeconds(this.duration),this.sizeFormatted=this._formatSize(this.size)}},{key:"_removeCaption",value:function(){return this.audioEl.next(".audio-player-caption").remove(),this.audioEl.parent().next(".audio-player-caption").remove()}},{key:"_addImage",value:function(){return void 0!==this.image&&""!==this.image?this.innerEl.append('<div class="audio-player-image">\n  <img src="'+this.image+'" alt="">\n</div>'):this.$el.addClass("no-image")}},{key:"_addLicenseWithoutControls",value:function(){var e=void 0!==this.licenseUrl&&""!==this.licenseUrl?'<a href="'+this.licenseUrl+'">'+this.license+"</a>":"<span>"+this.license+"</span>";return this.middleEl.append('<div class="audio-player-license audio-player-unsupported-license">'+e+"</div>")}},{key:"_addControls",value:function(){var e=this,t=void 0!==this.licenseUrl&&""!==this.licenseUrl?'<a href="'+this.licenseUrl+'">'+this.license+"</a>":"<span>"+this.license+"</span>";return this.middleEl.append('<div class="audio-player-controls">\n  <div class="audio-player-play"></div>\n\n  <div class="audio-player-bar-wrapper">\n    <div class="audio-player-current-time">00:00</div>\n    <div class="audio-player-total-time">'+this.durationFormatted+'</div>\n    <div class="audio-player-license">'+t+"</div>\n  </div>\n</div>"),this.wrapperEl=this.$(".audio-player-bar-wrapper"),this.playEl=this.$(".audio-player-controls .audio-player-play"),this.currentTimeEl=this.$(".audio-player-controls .audio-player-current-time"),this.totalTimeEl=this.$(".audio-player-controls .audio-player-total-time"),this.superSliderView=new h,this.superSliderView.$el.appendTo(this.wrapperEl),this.superSliderView.on("changestart",function(){if(e.playEl.is(".playing"))return e._pause(),e.superSliderView.once("changefinish",e._play)}),this.superSliderView.on("change",function(t){return e._updateCurrentTime(t),e._updateCurrentTimestamp(t)})}},{key:"_addDownloadLink",value:function(){var e=this.link.split(".").pop().toUpperCase();return this.innerEl.append('<div class="audio-player-download">\n  <a href="'+this.link+'" title="Download">\n    <span class="audio-player-heading">'+i.a.t("audio_player.label.download")+'</span>\n    <span class="audio-player-download-icon"></span>\n    <span class="audio-player-download-info">'+e+" / "+this.sizeFormatted+"</span>\n  </a>\n</div>")}},{key:"_addTitle",value:function(){return this.middleEl.append('<div class="audio-player-listen">\n  <span class="audio-player-heading">'+i.a.t("audio_player.label.listen")+'</span>\n  <span class="audio-player-title">'+this.title+"</span>\n</div>")}},{key:"_moveSlider",value:function(e){return this.superSliderView.setValue(e)}},{key:"_updateCurrentTime",value:function(e){var t=this.duration*(e>100?100:e)/100;return this.audio.currentTime=t}},{key:"_updateCurrentTimestamp",value:function(e){var t=this.duration*(e/100);return this.currentTimeEl.get(0).textContent=this._formatSeconds(t)}},{key:"_onClickPlay",value:function(e){var t=o()(e.target);return t.toggleClass("playing"),t.is(".playing")?this._play():this._pause()}},{key:"_onTimeUpdate",value:function(e){var t=this._timeToPercent(this.audio.currentTime);return this._moveSlider(t),this._updateCurrentTimestamp(t)}},{key:"_onEnded",value:function(e){return this.playEl.removeClass("playing"),this.timeUpdateInterval&&clearInterval(this.timeUpdateInterval),this._moveSlider(0),this._updateCurrentTimestamp(0)}},{key:"_formatSeconds",value:function(e){e=Math.round(e);var t=Math.floor(e/3600),n=e%3600,i=Math.floor(n/60),r=n%60,o=Math.ceil(r);return 0===t?this._padded(i)+":"+this._padded(o):this._padded(t)+":"+this._padded(i)+":"+this._padded(o)}},{key:"_padded",value:function(e){for(var t=""+e;t.length<2;)t="0"+t;return t}},{key:"_formatSize",value:function(e){if(0===e)return"0";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return(0===t?e/Math.pow(1024,t):(e/Math.pow(1024,t)).toFixed(0))+" "+["bytes","KB","MB","GB"][t]}},{key:"_timeToPercent",value:function(e){var t=parseFloat(e)/parseInt(this.duration)*100;return t>100?100:t}}],[{key:"initClass",value:function(){this.prototype.events={"click .audio-player-play":"_onClickPlay"},this.prototype.className="audio-player",this.prototype.template=Object(a.template)('<div class="audio-player-inner">\n  <div class="audio-player-middle"></div>\n</div>')}}]),t}()).initClass(),y=y)},47:function(e,t,n){"use strict";n.r(t);var i=n(1),r=n(3),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.default=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Model"]),o(t,[{key:"exists",value:function(){return this.get("type")}},{key:"isEditor",value:function(){return"Editor"===this.get("type")}},{key:"isAuthor",value:function(){return"Author"===this.get("type")}},{key:"isModerator",value:function(){return this.get("moderator")}},{key:"isConfirmedAuthor",value:function(){return"confirmed_expert"===this.get("author_profile_state")}},{key:"hasAccessTo",value:function(e){return-1!==Object(i.indexOf)(this.get("beta_features"),e)}},{key:"getProfileNotificationsUrl",value:function(){return"/profiles/"+this.get("slug")+"/notifications"}}]),t}()},48:function(e,t,n){"use strict";n.r(t),t.default={track:function(e,t,n,i,r){return null==n&&(n=""),null==i&&(i=1),null==r&&(r=!0),ga("send","event",e,t,n,i,{nonInteraction:r})}}},57:function(e,t,n){"use strict";var i=n(192),r=n.n(i);t.a=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r.a.init({selector:["iframe","object"],players:["c15119308.ssl.cf2.rackcdn.com","youtube.com","www.youtube.com","player.vimeo.com","maps.google.com","youtube-nocookie.com"]})}},62:function(e,t){var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var i=function(e){this.initialize(e),this.dragProperties=new r},r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.TIME_CHUNK=50,this.dragging=!1,this.mouseStartPosition={x:0,y:0},this.mousePosition={x:0,y:0},this.startPosition={x:0,y:0},this.targetPosition={x:0,y:0},this.interpolatedPosition={x:0,y:0},this.sliderPosition={x:0,y:0},this.containment={active:!1,xMin:0,xMax:0,yMin:0,yMax:0},this.timeAccumulator=0,this.previousFrameTime=0}return n(e,[{key:"setNewStartPosition",value:function(e,t){this.startPosition.x=e,this.startPosition.y=t,this.targetPosition.x=e,this.targetPosition.y=t}},{key:"setNewTargetPosition",value:function(){this.copyTargetToStart(),this.targetPosition.x=this.mousePosition.x-this.mouseStartPosition.x,this.targetPosition.y=this.mousePosition.y-this.mouseStartPosition.y}},{key:"copyTargetToStart",value:function(){this.startPosition.x=this.targetPosition.x,this.startPosition.y=this.targetPosition.y}},{key:"setContainment",value:function(e){this.containment.active=!0,this.containment.xMin=e.xMin,this.containment.xMax=e.xMax,this.containment.yMin=e.yMin,this.containment.yMax=e.yMax}},{key:"interpolate",value:function(e){this.interpolatedPosition.x=this.targetPosition.x*e+this.startPosition.x*(1-e),this.interpolatedPosition.y=this.targetPosition.y*e+this.startPosition.y*(1-e)}}]),e}();i.prototype={initialize:function(e){this.element=e.element,this.axis=e.axis,this.containment=e.containment,handleMousedown=this._handleMousedown.bind(this),handleTouchstart=this._handleTouchstart.bind(this),handleTrackMousedown=this._handleTrackMousedown.bind(this),handleTrackTouchstart=this._handleTrackTouchstart.bind(this),handleResize=this._handleResize.bind(this),this.element.addEventListener("mousedown",handleMousedown,!1),this.element.addEventListener("touchstart",handleTouchstart,!1),window.addEventListener("resize",handleResize,!1),this.containment&&"parent"==this.containment&&(this.element.parentNode.addEventListener("mousedown",handleTrackMousedown,!1),this.element.parentNode.addEventListener("touchstart",handleTrackTouchstart,!1))},setValue:function(e){this.dragProperties.sliderPosition.x=e,this.dragProperties.dragging||(translation="translate3d("+this.dragProperties.sliderPosition.x+"px, 0 , 0)",this.element.style.transform=translation,this.element.style.webkitTransform=translation)},setPercentValue:function(e){(this.element.parentNode.offsetWidth||this.element.parentNode.offsetHeight)&&(offsetLeft=e*this.element.parentNode.offsetWidth/100,this.setValue(offsetLeft))},_beginDrag:function(e){this.handleMousemove=this._handleMousemove.bind(this),this.handleTouchmove=this._handleTouchmove.bind(this),this.handleMouseup=this._handleMouseup.bind(this),document.addEventListener("mousemove",this.handleMousemove,!1),document.addEventListener("touchmove",this.handleTouchmove,!1),document.addEventListener("mouseup",this.handleMouseup,!1),document.addEventListener("touchend",this.handleMouseup,!1),this.dragProperties.dragging=!0,this.dragProperties.setNewStartPosition(this.dragProperties.sliderPosition.x,this.dragProperties.sliderPosition.y),this.containment&&"parent"==this.containment&&this.dragProperties.setContainment({xMin:0,xMax:e.parentNode.offsetWidth,yMin:0,yMax:e.parentNode.offsetHeight});var t=new CustomEvent("dragstart",{});this.element.dispatchEvent(t),requestAnimationFrame(this._renderCallback.bind(this))},_renderCallback:function(e){var t=e-this.dragProperties.previousFrameTime;for(this.dragProperties.timeAccumulator+=t;this.dragProperties.timeAccumulator>=this.dragProperties.TIME_CHUNK;)this.dragProperties.setNewTargetPosition(),this.dragProperties.timeAccumulator-=this.dragProperties.TIME_CHUNK;var n=this.dragProperties.timeAccumulator/this.dragProperties.TIME_CHUNK;this.dragProperties.interpolate(n),this.dragProperties.sliderPosition.x=this.dragProperties.interpolatedPosition.x,this.dragProperties.containment.active&&(this.dragProperties.sliderPosition.x=Math.max(this.dragProperties.containment.xMin,Math.min(this.dragProperties.containment.xMax,this.dragProperties.sliderPosition.x)));var i=new CustomEvent("drag",{detail:{position:this.dragProperties.sliderPosition}});if(this.element.dispatchEvent(i),translation="translate3d("+this.dragProperties.sliderPosition.x+"px, 0 , 0)",this.element.style.transform=translation,this.element.style.webkitTransform=translation,this.dragProperties.dragging)requestAnimationFrame(this._renderCallback.bind(this));else{var r=new CustomEvent("dragfinish",{});this.element.dispatchEvent(r)}this.dragProperties.previousFrameTime=e},_finishDrag:function(e){this.dragProperties.dragging=!1},_handleMousemove:function(e){e.preventDefault(),this.dragProperties.mousePosition.x=e.pageX,this.dragProperties.mousePosition.y=e.pageY},_handleTouchmove:function(e){e.preventDefault(),this.dragProperties.mousePosition.x=e.touches[0].pageX,this.dragProperties.mousePosition.y=e.touches[0].pageY},_handleMousedown:function(e){e.preventDefault(),e.stopPropagation(),this.dragProperties.mouseStartPosition.x=e.pageX-this.dragProperties.sliderPosition.x,this.dragProperties.mouseStartPosition.y=e.pageY-this.dragProperties.sliderPosition.y,this.dragProperties.mousePosition.x=e.pageX,this.dragProperties.mousePosition.y=e.pageY,this._beginDrag(this.element)},_handleTouchstart:function(e){e.preventDefault(),e.stopPropagation(),this.dragProperties.mouseStartPosition.x=e.touches[0].pageX-this.dragProperties.sliderPosition.x,this.dragProperties.mouseStartPosition.y=e.touches[0].pageY-this.dragProperties.sliderPosition.y,this.dragProperties.mousePosition.x=e.touches[0].pageX,this.dragProperties.mousePosition.y=e.touches[0].pageY,this._beginDrag(this.element)},_handleTrackMousedown:function(e){this._snapToX(e.pageX),this._handleMousedown(e)},_handleTrackTouchstart:function(e){this._snapToX(e.touches[0].pageX),this._handleTouchstart(e)},_handleMouseup:function(e){e.preventDefault(),document.removeEventListener("mousemove",this.handleMousemove),document.removeEventListener("touchmove",this.handleTouchmove),document.removeEventListener("mousemove",this.handleMouseup),document.removeEventListener("touchend",this.handleMouseup),this._finishDrag(this.element)},_handleResize:function(e){var t=this.dragProperties.containment.xMax,n=this.dragProperties.containment.yMax,i=this.dragProperties.sliderPosition.x/t*this.element.parentNode.offsetWidth,r=this.dragProperties.sliderPosition.y/n*this.element.parentNode.offsetHeight;this.dragProperties.containment.xMax=this.element.parentNode.offsetWidth,this.dragProperties.containment.yMax=this.element.parentNode.offsetHeight,this.dragProperties.targetPosition.x=i,this.dragProperties.targetPosition.y=r,this.dragProperties.sliderPosition.x=i,this.dragProperties.sliderPosition.y=r;var o="translate3d("+this.dragProperties.sliderPosition.x+"px, 0 , 0)";this.element.style.transform=o,this.element.style.webkitTransform=o},_snapToX:function(e){var t=this.element.parentNode.getBoundingClientRect(),n=t.left,i=this.element.parentNode.offsetWidth+t.left;e=Math.max(n,Math.min(i,e))-t.left;this.dragProperties.sliderPosition.x=e}},e.exports=i},64:function(e,t,n){"use strict";var i=n(1),r=n(10),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=void 0;t.a=((a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a),o(t,[{key:"setColor",value:function(e){if(this.$el.removeClass(this.colors.join(" ")),null!=e){if(!Object(i.includes)(this.colors,e))throw new Error("unknown color '"+e+"'");return this.$el.addClass(e)}}}],[{key:"initClass",value:function(){this.GREEN="green",this.ORANGE="orange",this.RED="red",this.GREY="grey",this.prototype.className="button indicator",this.prototype.colors=[this.GREEN,this.ORANGE,this.RED,this.GREY]}}]),t}()).initClass(),a=a)},7:function(e,t,n){"use strict";var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(t){var n=this;r(this,e);var i=Object.assign({type:"notice"},t);this.body=document.createElement("p"),this.body.classList.add("flash","hidden",i.type),this.body.textContent=i.message,this.body.addEventListener("click",function(){return n.remove()})}return i(e,null,[{key:"parse",value:function(t){var n=new e({});n.body=t,n.body.addEventListener("click",function(){return n.remove()}),n.startRemoveTimeout()}}]),i(e,[{key:"show",value:function(){var e=this;document.body.appendChild(this.body),setTimeout(function(){e.body.classList.add("show"),e.body.classList.remove("hidden")},25),this.startRemoveTimeout()}},{key:"startRemoveTimeout",value:function(){setTimeout(this.remove.bind(this),5e3)}},{key:"remove",value:function(){var e=this;this.body.classList.remove("show"),this.body.classList.add("hidden"),setTimeout(function(){return e.body.remove()},500)}}]),e}(),a=function(){function e(){r(this,e)}return i(e,null,[{key:"bindServerFlash",value:function(){Array.from(document.querySelectorAll("p.flash")).forEach(function(e){return o.parse(e)})}},{key:"now",value:function(e,t){new o({type:e,message:t}).show()}}]),e}();t.a=a},8:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(6),a=n.n(o),s=n(3),l=(n(27),n(46)),u=n(2),c=n(48),p=n(7),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var h=void 0,d=((h=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),f(t,[{key:"initialize",value:function(e){if(function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),TC.currentUser.get("email"))return this.$el.find("input[name='subscribe[email]']").val(TC.currentUser.get("email"))}},{key:"_submitSignup",value:function(e){e.preventDefault();var t=r()(e.currentTarget);return t.removeClass("success").removeClass("failure").addClass("submitting"),t.find("input.button").addClass("disabled"),r.a.ajax({url:"/subscriptions",type:"POST",dataType:"json",data:t.serializeArray(),success:function(e){return t.removeClass("submitting").addClass("success"),p.a.now("notice",e.msg),c.default.track("Newsletter signups",document.location.pathname,"",1)},error:function(e){return t.removeClass("submitting").addClass("failure"),429===e.status?p.a.now("alert",u.a.t("newsletter.message.too_many_requests")):p.a.now("alert",JSON.parse(e.responseText).msg)},complete:function(e){return t.find("input.button").removeClass("disabled")}})}}],[{key:"initClass",value:function(){this.prototype.events={"submit form":"_submitSignup"}}}]),t}()).initClass(),h=h),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["View"]),m(t,[{key:"initialize",value:function(){this.makeRoomForFooter(),r()(window).on("resize",this.makeRoomForFooter.bind(this))}},{key:"makeRoomForFooter",value:function(){this.$el.css({minHeight:r()(window).height()-this.options.topbar.outerHeight()-this.options.footers.outerHeight()-parseInt(this.$el.css("padding-top"),10)})}}]),t}(),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var v=void 0,_=((v=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),b(t,[{key:"initialize",value:function(e){return this._subscribe=this._subscribe.bind(this),this._facebook=this._facebook.bind(this),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"_subscribe",value:function(e){return e.preventDefault(),TC.analytics.track("Newsletter subscription - Stay Informed topbar",document.location.pathname,"",1),window.location=r()(e.currentTarget).find("a").attr("href")}},{key:"_facebook",value:function(e){return e.preventDefault(),TC.analytics.track("Region Facebook - Stay Informed topbar",document.location.pathname,"",1),window.location=r()(e.currentTarget).find("a").attr("href")}}],[{key:"initClass",value:function(){this.prototype.events={"click .topbar-button.newsletter":"_subscribe","click .topbar-button.facebook":"_facebook","click .topbar-button.twitter":"_twitter"}}}]),t}()).initClass(),v=v),g=n(1),w=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var O=void 0,k=((O=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),w(t,[{key:"initialize",value:function(e){return this._openMenu=this._openMenu.bind(this),this._closeMenu=this._closeMenu.bind(this),this._documentClickHandler=this._documentClickHandler.bind(this),null==e&&(e={}),this.menuButtonOpen=this.$el.find(".menu-button-open"),this.menuButtonOpen.show(),this.menuButtonOpen.on("click",this._openMenu),this.menuButtonOpen.after(this.menuClose()),this.menuButtonClose=this.$el.find(".menu-button-close"),this.menuButtonClose.on("click",this._closeMenu),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"_openMenu",value:function(e){var t=this;return e.preventDefault(),this.$el.addClass("open"),this.menuButtonOpen.hide(),this.menuButtonClose.show(),Object(g.defer)(function(){return r()(document).on("click",t._documentClickHandler)})}},{key:"_closeMenu",value:function(e){var t=this;return null!=e&&e.preventDefault(),this.$el.removeClass("open"),this.menuButtonOpen.show(),this.menuButtonClose.hide(),Object(g.defer)(function(){return r()(document).off("click",t._documentClickHandler)})}},{key:"_documentClickHandler",value:function(e){return e.stopPropagation(),this._closeMenu()}}],[{key:"initClass",value:function(){this.prototype.menuClose=Object(g.template)("<a class='menu-button-close' href='#'><%- i18n.t(\"top_bar.close_menu\") %></a>",{imports:{i18n:u.a}})}}]),t}()).initClass(),O=O),C=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var j=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["View"]),C(t,[{key:"initialize",value:function(e){return this._toggle=this._toggle.bind(this),null==e&&(e={}),this.editorialMenu=this.$el.find(".editorial-menu"),this.editorialMenu.find(".toggle").on("click",this._toggle)}},{key:"_toggle",value:function(e){return e.preventDefault(),this.editorialMenu.toggleClass("opened")}}]),t}(),P=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var T=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s["View"]),P(t,[{key:"initialize",value:function(e){this._open=this._open.bind(this),this._toggle=this._toggle.bind(this),null==e&&(e={}),this.editorialGrid=this.$el.find(".editorial-grid"),this.editorialMenu=this.editorialGrid.find(".editorial-sidebar"),this.editorialMenu.append("<a href='#' class='cover'></a>"),this.editorialMenu.find("h3 a").on("click",this._open),this.editorialMenu.find(".cover").on("click",this._toggle),this.editorialMenu.find(".editorial-sidebar-group").show()}},{key:"_open",value:function(e){return e.preventDefault(),this.editorialGrid.addClass("editorial-sidebar-opened"),r()(e.currentTarget).parents(".editorial-sidebar-group").toggleClass("opened")}},{key:"_toggle",value:function(e){return e.preventDefault(),this.$el.find(".editorial-sidebar-group").removeClass("opened"),this.editorialGrid.toggleClass("editorial-sidebar-opened")}}]),t}(),S=function(e){var t,n,i=r()("#small-sidebar");e.preventDefault(),i[0].className="visible",t=r()("#small-sidebar-overlay"),n=r()("#page-wrapper"),t[0].className="visible",n[0].className="overlay-visible"},E=function(e){var t,n,i;e.preventDefault(),(t=r()("#small-sidebar")).hasClass("visible")&&(t[0].className="hidden"),n=r()("#page-wrapper"),(i=r()("#small-sidebar-overlay")).hasClass("visible")&&(i[0].className="hidden",n[0].className="")},x=function(){r()("#small-sidebar-open-button").on("click",S),r()("#small-sidebar-close-button").on("click",E),r()("#small-sidebar-overlay").on("click",E),r()("#small-region-select-dropdown").on("change",function(e){window.location=e.target.value})},D=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var M=void 0;t.default=((M=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,s.View),D(t,[{key:"initialize",value:function(e){var t=this;return this.topbar=this.$("#topbar"),this.footers=this.$("#footers"),this.newsletterSignUpForm=this.$(".newsletter-signup-form").each(function(e,n){return t.newsletterSignUpFormView=new d({el:n})}),this.audioPlayers=this.$("audio").each(function(e,t){return new l.a({audioEl:t})}),this.outer=this.$("#outer").first().each(function(e,n){return t.outerView=new y({el:n,topbar:t.topbar,footers:t.footers})}),this.editorialSidebarMenu=new T({el:this.$el}),this.editorialMenu=new j({el:this.$el}),this._initSVGHandling(),this._initJSHandling(),this._initLocalTimes(),this._initRelativeTimes(),this._initFlashMessages(),this._initTopbarMenu(),this._initSmallLayout(),this._checkHttpsCapable()}},{key:"_initLocalTimes",value:function(){return r()("time[data-format]").each(function(e,t){var n=r()(t).data("format"),i=r()(t).attr("datetime");if(n&&i){var o=a()(i);return r()(t).html(TC.time.formatted(o,n)),r()(t).attr("title",o.toDate())}})}},{key:"_initRelativeTimes",value:function(){return r()("time[data-relative]").each(function(e,t){var n=r()(t).attr("datetime");if(n){var i=a()(n);return r()(t).html(i.fromNow()),r()(t).attr("title",i.toDate())}})}},{key:"_initSVGHandling",value:function(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")?r()("html").addClass("svg"):r()("html").addClass("no-svg")}},{key:"_initJSHandling",value:function(){return r()("html").addClass("js").removeClass("no-js")}},{key:"_initFlashMessages",value:function(){p.a.bindServerFlash()}},{key:"_initTopbarMenu",value:function(){return new k({el:this.$(".topbar-edition-selector")}),new k({el:this.$(".topbar-account-nav")}),new _({el:this.$(".topbar-stay-informed")})}},{key:"_checkHttpsCapable",value:function(){if(window.location.protocol&&"http:"===window.location.protocol)return r()("body[data-https='available']").each(function(){var e="https://"+window.location.hostname+":"+window.location.port+"/secure-check";return r.a.ajax({url:e})})}}],[{key:"initClass",value:function(){this.prototype.el=document.body,this.prototype._initSmallLayout=x}}]),t}()).initClass(),M=M)},82:function(e,t,n){"use strict";var i=n(0),r=n.n(i),o=n(1),a=n(3),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["View"]),s(t,[{key:"initialize",value:function(e){return this._listenToOutsideClick=this._listenToOutsideClick.bind(this),function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"show",value:function(){return this.$el.show()}},{key:"hide",value:function(){return this.$el.hide()}},{key:"toggle",value:function(){return this.$el.is(":visible")?this.hide():(this.show(),this._listenToOutsideClick())}},{key:"_listenToOutsideClick",value:function(){var e=this;return Object(o.defer)(function(){var t=e.$el[0].className.split(" ")[0];return r()("body").one("click.tooltip focusin.tooltip",function(n){return r()(n.target).hasClass(t)||r()(n.target).parents("."+t).length>0?e._listenToOutsideClick():(r()("body").off("click.tooltip focusin.tooltip"),e.hide())})})}}]),t}()},83:function(e,t,n){"use strict";t.a={scrollYPosition:function(){return window.pageYOffset||document.documentElement.scrollTop},slugParser:function(e){var t;return(t=e.match(/theconversation.com\/.*-(\d+)$/))?t[1]:null}}},838:function(e,t,n){},839:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(8),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var s=void 0;t.default=((s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),a(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"_clickHandheldTab",value:function(e){e.preventDefault();var t=r()(e.target).attr("href");switch(r()("#tabbed-navigation a.active").removeClass("active"),r()(e.target).addClass("active"),t){case"#articles":return r()(".topic-page").removeClass("sm-display-contributors sm-display-links"),r()(".topic-page").addClass("sm-display-articles");case"#contributors":return r()(".topic-page").removeClass("sm-display-articles sm-display-links"),r()(".topic-page").addClass("sm-display-contributors");case"#links":return r()(".topic-page").removeClass("sm-display-articles sm-display-contributors"),r()(".topic-page").addClass("sm-display-links")}}},{key:"_showMoreExperts",value:function(e){return e.preventDefault(),r()(".expert-authors").addClass("show-all")}}],[{key:"initClass",value:function(){this.prototype.events={"click #tabbed-navigation a":"_clickHandheldTab","click .expert-authors .more a":"_showMoreExperts"}}}]),t}()).initClass(),s=s)},840:function(e,t,n){(t=e.exports=n(22)(!1)).push([e.i,".international-newsletters-heading-1MLdf {\n  margin: 40px 0 20px; }\n\n.spinner-container-3X8ie {\n  margin: 40px 0;\n  -webkit-transform: scale(2);\n  -ms-transform: scale(2);\n  transform: scale(2); }\n\n@media (max-width: 480px) {\n  .spinner-container-3X8ie {\n    margin: 20px 0;\n    -webkit-transform: scale(1);\n    -ms-transform: scale(1);\n    transform: scale(1); } }\n",""]),t.locals={"international-newsletters-heading":"international-newsletters-heading-1MLdf","spinner-container":"spinner-container-3X8ie"}},841:function(e,t,n){(t=e.exports=n(22)(!1)).push([e.i,".container-1C2LN {\n  -webkit-box-align: stretch;\n  -webkit-align-items: stretch;\n  -ms-flex-align: stretch;\n  align-items: stretch;\n  background: #fafafa;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  margin-bottom: 20px; }\n\n.image-1u3UG {\n  padding: 20px 0;\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n  align-self: center;\n  width: 20%;\n  text-align: center; }\n  .image-1u3UG img {\n    width: 50%; }\n\n.description-221xI {\n  padding: 20px 0;\n  padding-left: 20px;\n  padding-right: 20px;\n  width: 65%; }\n\n.description-region-2opDo {\n  font-size: 16px;\n  font-weight: normal; }\n\n.description-blurb-3-Ral {\n  margin-top: 20px; }\n\n.description-frequency-1Z7lK {\n  color: #999; }\n\n.toggle-switch-1ydsS {\n  padding: 20px 0;\n  background: #f3f3f3;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  width: 15%; }\n\n.toggle-switch-element-3dEO1 {\n  margin: 0 auto;\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n  align-self: center; }\n\n@media (max-width: 480px) {\n  .container-1C2LN {\n    -webkit-box-orient: vertical;\n    -webkit-box-direction: normal;\n    -webkit-flex-direction: column;\n    -ms-flex-direction: column;\n    flex-direction: column; }\n  .image-1u3UG {\n    width: 100%; }\n  .description-221xI {\n    width: 90%; }\n  .toggle-switch-1ydsS {\n    width: 100%; } }\n",""]),t.locals={container:"container-1C2LN",image:"image-1u3UG",description:"description-221xI","description-region":"description-region-2opDo","description-blurb":"description-blurb-3-Ral","description-frequency":"description-frequency-1Z7lK","toggle-switch":"toggle-switch-1ydsS","toggle-switch-element":"toggle-switch-element-3dEO1"}},842:function(e,t,n){(t=e.exports=n(22)(!1)).push([e.i,".selector-2heQc {\n  margin-bottom: 30px; }\n  .selector-2heQc label {\n    float: left;\n    font-weight: bold;\n    margin-right: 15px; }\n",""]),t.locals={selector:"selector-2heQc"}},843:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(208),a=n(8),s=n(14),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.default=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["default"]),l(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.initAutoComplete()}},{key:"initAutoComplete",value:function(){return Object(s.a)(r()(".research-code.autocomplete"),{source:"/field_of_researches.json",minLength:2,autoFocus:!0,delay:200,select:function(e,t){return e.preventDefault(),r()(this).val(t.item.code)}}),Object(s.a)(r()(".funding-source.autocomplete"),{source:"/funding_sources.json",minLength:2,autoFocus:!0,delay:200,select:function(e,t){return e.preventDefault(),r()(this).val(t.item.label)}}),Object(s.a)(r()(".credential-title.autocomplete"),{source:o.a.list,minLength:2,autoFocus:!0,delay:200,select:function(e,t){return this.val(t.item)}}),Object(s.a)(r()(".professional-membership.autocomplete"),{source:"/professional_memberships.json",select:function(e,t){return e.preventDefault(),r()(this).val(t.item.label)}})}}]),t}()},844:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(8),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var s=void 0;t.default=((s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),a(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e)}},{key:"changeSort",value:function(){var e=r()("#podcast-sort").val(),t=document.location.pathname+"?sort="+e;return document.location.href=t}}],[{key:"initClass",value:function(){this.prototype.events={"change #podcast-sort":"changeSort"}}}]),t}()).initClass(),s=s)},845:function(e,t,n){"use strict";n.r(t);var i=n(8),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var o=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{events:{"click #newsletter-archive .button":"showMore"}}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["default"]),r(t,[{key:"showMore",value:function(){this.$el.find("#newsletter-archive .hidden").show(),this.$el.find("#newsletter-archive .button").hide()}}]),t}();t.default=o},846:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(8),a=n(134),s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var l=void 0;t.default=((l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),s(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.institutionSlug=window.location.pathname.replace("/institutions/",""),new a.a({el:r()("body"),institutionSlug:this.institutionSlug})}},{key:"_clickHandheldTab",value:function(e){e.preventDefault();var t=r()(e.target).attr("href");switch(r()("#tabbed-navigation a.active").removeClass("active"),r()(e.target).addClass("active"),t){case"#articles":return r()(".institution-page").removeClass("sm-display-contributors sm-display-jobs-and-events"),r()(".institution-page").addClass("sm-display-articles");case"#contributors":return r()(".institution-page").removeClass("sm-display-articles sm-display-jobs-and-events"),r()(".institution-page").addClass("sm-display-contributors");case"#jobs-and-events":return r()(".institution-page").removeClass("sm-display-articles sm-display-contributors"),r()(".institution-page").addClass("sm-display-jobs-and-events")}}}],[{key:"initClass",value:function(){this.prototype.events={"click #tabbed-navigation a":"_clickHandheldTab"}}}]),t}()).initClass(),l=l)},847:function(e,t,n){"use strict";n.r(t);var i=n(8),r=n(57),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.default=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["default"]),o(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),new r.a}}]),t}()},848:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(13),a=n(14),s=n(208),l=n(8),u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var c=void 0;t.default=((c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.default),u(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._crop=this._crop.bind(this),this.autocompleteInstitution(),this.autocompleteJobTitle()}},{key:"showPhoto",value:function(e){var t=this,n=r()(".avatar > img"),i=r()(e.currentTarget).get(0);if(this._fileReaderExists()&&this._inputHasFiles(i)){var o=new FileReader;return o.onload=function(e){var i=new Image;return i.onload=function(e){return t._crop(n,e.currentTarget)},i.src=e.target.result},o.readAsDataURL(i.files[0])}}},{key:"chooseOther",value:function(e){var t=r()(e.currentTarget).siblings("label.other-radio-option").find("input[type=radio]");return r()("input[name='"+t.attr("name")+"']").prop("checked",!1),t.prop("checked",!0)}},{key:"focusOtherInput",value:function(e){return r()(e.currentTarget).parent().siblings(".other-radio-option").focus()}},{key:"autocompleteInstitution",value:function(){var e=r()("#profile_form_institution"),t=new o.default({title:e.data("label")||"Select an institution",source:"/institutions/search.json"});return e.after(t.$el),t.on("selected",function(t){return e.val(t.institution.id)})}},{key:"autocompleteJobTitle",value:function(){return Object(a.a)(r()(".occupation.autocomplete"),{source:s.a.list,minLength:2,autoFocus:!0,delay:200,select:function(e,t){return this.val(t.item)}})}},{key:"_fileReaderExists",value:function(){return"undefined"!=typeof FileReader}},{key:"_inputHasFiles",value:function(e){return e.files&&e.files[0]}},{key:"_getCroppedImageElementFor",value:function(e){var t=e.parent(),n=t.find(".replacedAvatar");return n.length>0?n:(t.append("<div class='replacedAvatar'></div>"),t.find(".replacedAvatar"))}},{key:"_crop",value:function(e,t){var n=this._getCroppedImageElementFor(e);return n.hide(),n.css("background","url("+t.src+") no-repeat center center"),n.css("background-size","cover"),n.width(e.width()),n.height(e.height()),e.hide(),n.fadeIn()}}],[{key:"initClass",value:function(){this.prototype.events={"change li.file.input input":"showPhoto","click li.choice input.other-radio-option":"chooseOther","change li.choice .other-option-label input[type=radio]":"focusOtherInput"}}}]),t}()).initClass(),c=c)},849:function(e,t,n){"use strict";n.r(t);var i=n(8),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.default=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["default"]),r(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this.$("input#user_password").focus()}}]),t}()},85:function(e,t,n){var i=n(219);"string"==typeof i&&(i=[[e.i,i,""]]);var r={transform:void 0};n(21)(i,r);i.locals&&(e.exports=i.locals)},850:function(e,t,n){"use strict";n.r(t);var i=n(57),r=n(8),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=void 0;t.default=((a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.default),o(t,[{key:"initialize",value:function(e){return function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"initialize",this).call(this,e),this._toggleColumnSidebar=this._toggleColumnSidebar.bind(this),this._toggleTranslationSidebar=this._toggleTranslationSidebar.bind(this),new i.a}},{key:"_toggleColumnSidebar",value:function(e){return e.preventDefault(),this.$el.find(".content-sidebar").toggleClass("open")}},{key:"_toggleTranslationSidebar",value:function(e){return e.preventDefault(),this.$el.find(".content-translations").toggleClass("open")}}],[{key:"initClass",value:function(){this.prototype.events={"click .content-authors .content-authors-toggle":"_toggleColumnSidebar","click .content-translations .content-translations-toggle":"_toggleTranslationSidebar"}}}]),t}()).initClass(),a=a)},86:function(e,t,n){"use strict";var i=n(0),r=n.n(i),o=n(3),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var s,l=void 0;t.a=(s=void 0,(l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.View),a(t,[{key:"initialize",value:function(e){var t=r()(e.el)[0];if(e.count&&0!==e.count)return r()('<span class="data-count" />').text(s(e.count)).insertAfter(r()(t))}}],[{key:"initClass",value:function(){s=function(e){return e<1e3?e:Math.round(e/100)/10+"k"}}}]),t}()).initClass(),l=l)},87:function(e,t,n){var i=n(841);"string"==typeof i&&(i=[[e.i,i,""]]);var r={transform:void 0};n(21)(i,r);i.locals&&(e.exports=i.locals)},965:function(e,t,n){n(384),e.exports=n(838)},97:function(e,t,n){"use strict";n.r(t);var i=n(6),r=n.n(i),o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var a=void 0;t.default=((a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setDatePickerLocale(t),r.a.locale(t,this.locales[t])}return o(e,null,[{key:"initClass",value:function(){this.prototype.formats={tc_date:"MMMM D, YYYY",tc_short_month_date:"MMM D, YYYY",tc_date_with_time:"MMMM D, YYYY h.mma",tc_time:"h.mma"},this.prototype.locales={"fr-FR":{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"une année",yy:"%d années"},ordinalParse:/\d{1,2}(er|ème)/,ordinal:function(e){var t;return e+(null!=(t=1===e)?t:{er:"ème"})},meridiemParse:/PD|MD/,isPM:function(e){return"M"===e.charAt(0)},rangeSelectorFrom:"Du",rangeSelectorTo:"au"},"id-ID":{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",LTS:"HH.mm.ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] HH.mm",LLLL:"dddd, D MMMM YYYY [pukul] HH.mm"},meridiemParse:/pagi|siang|sore|malam/,meridiemHour:function(e,t){return 12===e&&(e=0)," pagi"===t?e:" siang"===t?e>=11?e:e+12:" sore"===t||" malam"===t?e+12:void 0},meridiem:function(e,t,n){return e<11?" pagi":e<15?" siang":e<19?" sore":" malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},rangeSelectorFrom:"Dari",rangeSelectorTo:"untuk"}}}}]),o(e,[{key:"formatted",value:function(e,t){return null==t&&(t="tc_date_with_time"),r()(e).format(this.formats[t])}},{key:"setDatePickerLocale",value:function(e){if(("fr-FR"===e||"id-ID"===e)&&"undefined"!=typeof Highcharts)return Highcharts.setOptions({lang:{months:this.locales[e].months,shortMonths:this.locales[e].monthsShort,weekdays:this.locales[e].weekdays,rangeSelectorFrom:this.locales[e].rangeSelectorFrom,rangeSelectorTo:this.locales[e].rangeSelectorTo}})}}]),e}()).initClass(),a=a)}},[[965,0,1]]]);